<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-coding/JS/Electron/electron-howto">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/docusaurus/blog/rss.xml" title="南川笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docusaurus/blog/atom.xml" title="南川笔记 Atom Feed">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">electron howto | 南川笔记</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docusaurus/docs/coding/JS/Electron/electron-howto"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="electron howto | 南川笔记"><meta data-rh="true" name="description" content="1. electron best practice"><meta data-rh="true" property="og:description" content="1. electron best practice"><link data-rh="true" rel="icon" href="/docusaurus/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docusaurus/docs/coding/JS/Electron/electron-howto"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docusaurus/docs/coding/JS/Electron/electron-howto" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docusaurus/docs/coding/JS/Electron/electron-howto" hreflang="x-default"><link rel="stylesheet" href="/docusaurus/assets/css/styles.6bbfa55a.css">
<link rel="preload" href="/docusaurus/assets/js/runtime~main.342ff705.js" as="script">
<link rel="preload" href="/docusaurus/assets/js/main.f7bbc373.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docusaurus/"><div class="navbar__logo"><img src="/docusaurus/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docusaurus/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">南川笔记</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docusaurus/docs/">My Docs</a><a class="navbar__item navbar__link" href="/docusaurus/blog">My Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/markshawn2020/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus/docs/">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docusaurus/docs/TODO">TODO</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="true" href="/docusaurus/docs/SLAM/A01-recognizeLights">SLAM</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/SLAM/A01-recognizeLights">A01: recognize lights</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/SLAM/slam-research">slam-research</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/SLAM/slambook2-ch13">slambook2-ch13</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/SLAM/slambook2-learning">slambook2-learning</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docusaurus/docs/AndroidFramework/TaskA1-aosp-pull/aosp-pull">AndroidFramework</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docusaurus/docs/OS/Linux/centos-init-manual">OS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docusaurus/docs/coding/CPP/cpp-howto">coding</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/CPP/cpp-howto">CPP</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/CSS/css-howto">CSS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/Go/go-howto">Go</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/HTML/html-howto">HTML</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docusaurus/docs/coding/JS/CodeQuality_eslint_prettier_jest/eslint-howto">JS</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/JS/CodeQuality_eslint_prettier_jest/eslint-howto">CodeQuality_eslint_prettier_jest</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/docusaurus/docs/coding/JS/Electron/electron-bugfix">Electron</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/Electron/electron-bugfix">electron-bugfix</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docusaurus/docs/coding/JS/Electron/electron-howto">electron howto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/Electron/electron-prisma-sqlite-2">electron prisma sqlite 2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/Electron/marknote-electron-prisma-sqlite">marknote-electron-prisma-sqlite</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/JS/React/react-howto">React</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/JS/Vue/vue-howto">Vue</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/database">database</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/develop-remark-plugin">develop-remark-plugin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/js-bugfix">js-bugfix</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/js-discuss">js discuss</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/js-howto">js-howto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/npm_yarn-bugfix">npm/yarn bugfix</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/npm_yarn-howto">npm/yarn howto</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/JS/redux">redux</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/Java/java-howto">Java</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/Markdown/markdown-howto">Markdown</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/Python/Python-Finance/">Python</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/TS/ts-bugfix">TS</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/Unity/unity-howto">Unity</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/coding-best-practice">coding best practice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docusaurus/docs/coding/coding-design">编程设计艺术思考（持续更新）</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/docusaurus/docs/coding/regex/regex-howto">regex</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docusaurus/docs/notes/blog-investigation">notes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docusaurus/docs/softwares/Adobe/PS/support-for-little-stars/">softwares</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/docusaurus/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">coding</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">JS</span><meta itemprop="position" content="2"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Electron</span><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">electron howto</span><meta itemprop="position" content="4"></li></ul></nav><span class="theme-doc-version-badge badge badge--secondary">版本：0.16.0+</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>electron howto</h1><ol><li><a href="#electron-best-practice">electron best practice</a><ol><li><a href="#design-of-dependency-workflow">design of dependency workflow</a></li><li><a href="#app-path-storing-db-log-etc">app path, storing db, log, etc</a></li><li><a href="#log-into-file">log into file</a></li></ol></li><li><a href="#electron-test">electron test</a></li><li><a href="#sqlite-best-practice">sqlite best practice</a><ol><li><a href="#dont-use-relative-path-as-sqlite-position">don&#x27;t use relative path as sqlite position</a></li></ol></li><li><a href="#log-electron">log electron</a><ol><li><a href="#todo-idealog-color-configuration">TODO: idealog color configuration</a></li></ol></li><li><a href="#build-for-windows-on-mac">build for Windows on Mac</a></li><li><a href="#build-native-dependencies-and-for-multi-platforms">build native dependencies and for multi platforms</a></li><li><a href="#custom-app-logo">custom app logo</a><ol><li><a href="#a-good-start">a good start</a></li><li><a href="#customize-icon-for-unpacked-app">customize icon for unpacked app</a></li><li><a href="#square-icon">square .icon</a></li></ol></li><li><a href="#electron-builder-files-map">electron-builder <code>files</code> map</a></li><li><a href="#%EF%B8%8F%EF%B8%8F%EF%B8%8F-debug-binary-electron">⭐️⭐️⭐️ debug binary electron</a></li><li><a href="#ipcrenderer-communication"><code>ipcRenderer</code> communication</a></li><li><a href="#hwo-to-use-preloadts">hwo to use <code>preload.ts</code></a><ol><li><a href="#the-preload-script-wont-run-if-we-just-start-the-main-process">the <code>preload</code> script won&#x27;t run if we just start the main process</a></li><li><a href="#its-ok-when-we-just-use-preloadjs">it&#x27;s ok when we just use <code>preload.js</code></a></li><li><a href="#what-about-using-a-preloadts">what about using a <code>preload.ts</code></a><ol><li><a href="#remedy-1-the-tsc-solution">remedy 1, the <code>tsc</code> solution</a></li></ol></li><li><a href="#how-to-remedy-the--electron-react-boilerplate-project">how to remedy the  <code>electron-react-boilerplate</code> project</a></li></ol></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="electron-best-practice">electron best practice<a class="hash-link" href="#electron-best-practice" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="design-of-dependency-workflow">design of dependency workflow<a class="hash-link" href="#design-of-dependency-workflow" title="标题的直接链接">​</a></h3><img loading="lazy" alt="picture 35" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641598093588-a14b7935afbcc384502d11ece03eab4f86772b695bfe904cd39f8180e934d21b.png" class="img_ev3q"><p>How to organize your project structure quite depends on your project scale and
realization.</p><p>For example, since my project is not too big, I combined almost all the constant
variables into one file <code>const.ts</code> in each module, containing <code>channels</code>
, <code>error_types</code>, <code>defined variables</code>, etc.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="app-path-storing-db-log-etc">app path, storing db, log, etc<a class="hash-link" href="#app-path-storing-db-log-etc" title="标题的直接链接">​</a></h3><p>Since the <code>userData</code> is the sub path of <code>appData</code> with the name of our
application, so it&#x27;s better to put all of our data into <code>userData</code>.</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// src/main/base/utils.ts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">getRootPath</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> app</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPath</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;userData&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">getLogPath</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">getRootPath</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;main.log&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">getDbPath</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">getRootPath</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;hjxh_data.sqlite&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>!!!tip If run under the development, since the app is run via <code>electron .</code>, so
the <code>userData</code> points to the <code>Electron</code>, which is different from the real build
version with the actual name defined in our <code>package.json/build</code>.</p><p>ref:</p><ul><li><a href="https://www.electronjs.org/docs/v14-x-y/api/app#appgetapppath" target="_blank" rel="noopener noreferrer">app | Electron</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-into-file">log into file<a class="hash-link" href="#log-into-file" title="标题的直接链接">​</a></h3><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transports</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function-variable function" style="color:#d73a49">resolvePath</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getLogPath</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">transports</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">file</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">format      </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;{y}-{m}-{d} {h}:{i}:{s}.{ms} {level}: {text}&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>ref:</p><ul><li><a href="https://github.com/megahertz/electron-log#overriding-consolelog" target="_blank" rel="noopener noreferrer">megahertz/electron-log: Just a simple logging module for your Electron application</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="electron-test">electron test<a class="hash-link" href="#electron-test" title="标题的直接链接">​</a></h2><p>When all the <code>ts-node / esm</code> relative environment is prepared well, there still
exists some problems.</p><p>For example, concerning about database, since I use it derived from app runtime,
and then it would not be mocked unless we start our script as a real electron
app rather than a script for unittest.</p><img loading="lazy" alt="picture 36" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641634838700-73855e534fc5987fd8ae13abe4a70a08ac88078a46f1dafa4857981f244c0484.png" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sqlite-best-practice">sqlite best practice<a class="hash-link" href="#sqlite-best-practice" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dont-use-relative-path-as-sqlite-position">don&#x27;t use relative path as sqlite position<a class="hash-link" href="#dont-use-relative-path-as-sqlite-position" title="标题的直接链接">​</a></h3><p>When using relative path, many packages including system would treat it on the
base of current process directory.</p><p>However, if the application is build into binary and run by click, then the
behavior would become a bit different since e.g. in Mac the application is run
with <code>process.cwd() = &#x27;/&#x27;</code>.</p><p>And then if we write our data into a sqlite which is created with relative path,
such as <code>./test.db</code>, then the error would arise up because of permission.</p><p>So the best practice is to use <code>AppData</code> directory
via <code>path.join(app.getPath(&#x27;appData&#x27;), dbName)</code>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="log-electron">log electron<a class="hash-link" href="#log-electron" title="标题的直接链接">​</a></h2><p>There are two places where console.log output goes:</p><p>If you log in the renderer process, you can see it in the console in the browser
window. If you open the dev tools programmatically you can see this console even
after building.</p><p>If you log in the main process, you can see these messages <strong>if you start the
installed app or the unpacked binary via command line</strong>. In windows this would
be the app.exe in the win-unpacked directory that electron-builder creates.</p><p>Another alternative would be a logger like <code>electron-log</code> that writes the log
messages into a configured file.</p><p>ref:</p><ul><li><a href="https://stackoverflow.com/questions/51866016/electron-where-does-logging-go/51881711" target="_blank" rel="noopener noreferrer">node.js - Electron - Where does logging go? - Stack Overflow</a></li></ul><p>And I am surprised to find that it has been in the <code>electron-react-typescript</code>
boilerplate.</p><img loading="lazy" alt="picture 9" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641400174339-197d9edb335e41d6d68eae58bf512f6cec757749415defd5fa87fb63c537ac0e.png" class="img_ev3q"><p>And it&#x27;s used for <code>Auto-Update</code>.</p><img loading="lazy" alt="picture 10" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641400215835-87f663610072a1e27f1da23a200f39b21f3e3f798a27270d1e9e5dd5d37ea255.png" class="img_ev3q"><p>ref:</p><ul><li><p><a href="https://github.com/megahertz/electron-log" target="_blank" rel="noopener noreferrer">megahertz/electron-log: Just a simple logging module for your Electron application</a></p></li><li><p><a href="https://stackoverflow.com/questions/41140960/where-can-i-find-the-logs-for-my-electron-app-in-production" target="_blank" rel="noopener noreferrer">logging - Where can I find the logs for my Electron app in production? - Stack Overflow</a></p></li></ul><p>However, it may not work since the output still goes into the terminal.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="todo-idealog-color-configuration">TODO: idealog color configuration<a class="hash-link" href="#todo-idealog-color-configuration" title="标题的直接链接">​</a></h3><h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-for-windows-on-mac">build for Windows on Mac<a class="hash-link" href="#build-for-windows-on-mac" title="标题的直接链接">​</a></h2><p>Using this command:</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">electron-builder build --win</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><img loading="lazy" alt="picture 4" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641369861536-a425061cf7dc95030f6e2d90279fa39a62333acf181bd5f415d5fc6d9c245643.png" width="480" class="img_ev3q"><p>But then:</p><img loading="lazy" alt="picture 5" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641370003105-4c933a2dae29f931f023269210b3a2d609cd218edd24c205643bfa2518f9aa2f.png" width="480" class="img_ev3q"><p>Hence, we need a mirror.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-native-dependencies-and-for-multi-platforms">build native dependencies and for multi platforms<a class="hash-link" href="#build-native-dependencies-and-for-multi-platforms" title="标题的直接链接">​</a></h2><p>It seems this is auto finished by <code>electron-builder</code>, which is described
at: <a href="https://www.electronjs.org/docs/latest/tutorial/using-native-node-modules#:~:text=This%20module%20can%20automatically%20determine%20the%20version%20of%20Electron%20and%20handle%20the%20manual%20steps%20of%20downloading%20headers%20and%20rebuilding%20native%20modules%20for%20your%20app." target="_blank" rel="noopener noreferrer">This module can automatically determine the version of Electron and handle the manual steps of downloading headers and rebuilding native modules for your app.</a></p><img loading="lazy" alt="picture 1" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641369455356-de2696cc998305e33a63cfa320438182cb1058f3219da95df2b3993541d870fe.png" width="480" class="img_ev3q"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="custom-app-logo">custom app logo<a class="hash-link" href="#custom-app-logo" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="a-good-start">a good start<a class="hash-link" href="#a-good-start" title="标题的直接链接">​</a></h3><p>All we need to do is to
follow: <a href="https://medium.com/fantageek/changing-electron-app-icon-acf26906c5ad" target="_blank" rel="noopener noreferrer">Changing electron app icon. Generate icns | by Khoa Pham | Fantageek | Medium</a></p><p>In which it directs us to
download <a href="https://github.com/onmyway133/IconGenerator" target="_blank" rel="noopener noreferrer">onmyway133/IconGenerator: 🍱 A macOS app to generate app icons</a></p><p>success when run after pack.</p><img loading="lazy" alt="picture 1" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641367831443-9ec96d4bce17056e6abf363cd144266c952a154a3aa7fec43afc2145d5ca028a.png" width="480" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="customize-icon-for-unpacked-app">customize icon for unpacked app<a class="hash-link" href="#customize-icon-for-unpacked-app" title="标题的直接链接">​</a></h3><p>If we wanner the icon does work in unpacked environment, we need to replace the
default icon in the module.</p><div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cp ./assets/icon.icns node_modules/electron/dist/Electron.app/Contents/Resources</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Or we can follow the above article, right click app, and change the icon.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="square-icon">square .icon<a class="hash-link" href="#square-icon" title="标题的直接链接">​</a></h3><p>When I pack for windows, it told me the icon size is at least &#x27;256 x 256&#x27;.</p><p>However I checked the raw image <code>xx.png</code>, and admitted that the size is far
bigger than this, but only to be converted to &#x27;256 x 204&#x27;.</p><p>I realized it may be owing to the size ratio, and I changed the image file into
a square one.</p><img loading="lazy" alt="picture 2" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641369646888-cd19bed16ca970d1b078ca722f2464221a47f054162de3bf10154efd5a1759e6.png" width="480" class="img_ev3q"><p>And then, it worked!</p><p>ref:</p><ul><li><a href="https://stackoverflow.com/questions/58351575/how-to-change-electronjs-app-default-icon" target="_blank" rel="noopener noreferrer">angular - How to Change ElectronJS App default Icon? - Stack Overflow</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="electron-builder-files-map">electron-builder <code>files</code> map<a class="hash-link" href="#electron-builder-files-map" title="标题的直接链接">​</a></h2><p>The current problem has become clarified, that is files not found.</p><p>We need a map, since I tried <code>files</code> but in vain.</p><img loading="lazy" alt="picture 1" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641148225241-7024811ff97dcbf12b0b6fbbd55ba645706c76be5464f6709b699d2bbd239c5f.png" width="480" class="img_ev3q"><p>Now, the problem is that the database would auto create after first query, while
it&#x27;s empty and then causes errors.</p><img loading="lazy" alt="picture 2" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/electron-howto-1641152259910-b7c6267ebdebb2f92da0194da0c417ea56039d03d07c10cc0726155b9b3b3e35.png" width="480" class="img_ev3q"><ul><li><a href="https://github.com/prisma/prisma/issues/9613" target="_blank" rel="noopener noreferrer">Using Prisma with the Electron Framework · Issue #9613 · prisma/prisma</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="️️️-debug-binary-electron">⭐️⭐️⭐️ debug binary electron<a class="hash-link" href="#️️️-debug-binary-electron" title="标题的直接链接">​</a></h2><p>Here&#x27;s what worked for me on Mac.</p><p>In terminal type <code>lldb path/to/build.app</code>
In the opened debugger type <code>run --remote-debugging-port=8315</code>. It should open a
window of your app. Open Chrome at <code>http://localhost:8315/</code>
Click on the name of the app. For example, Webpack App. If you don&#x27;t see
anything in the opened tab, focus on the window of your app.</p><p>ref:
<a href="https://stackoverflow.com/a/56634497/9422455" target="_blank" rel="noopener noreferrer">https://stackoverflow.com/a/56634497/9422455</a></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ipcrenderer-communication"><code>ipcRenderer</code> communication<a class="hash-link" href="#ipcrenderer-communication" title="标题的直接链接">​</a></h2><p>It deserves my attention that the msg interface from main process is
so-called <code>ipcMainEvent</code> which is not exported.</p><img loading="lazy" alt="picture 79" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640678460651-electron-howto-12d652220f222d268d792307f8e0523bfc5b47ea28c4b56795c240ed44fce75b.png" width="480" class="img_ev3q"><p>So, for typescript support, I need to define a &#x27;hooked ipcMainEvent&#x27; like this:</p><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">IpcMainEvent</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Event</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// eslint-disable-next-line @typescript-eslint/ban-types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    reply</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Function</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And when communicating, I should be careful with the difference between <code>on</code>
and <code>once</code>, and don&#x27;t forget to close the channel if need.</p><img loading="lazy" alt="picture 74" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640672448044-electron-howto-940254219636fb7b6bbdfea1faf735478526cefe89f48a4e6d2cef6acfe509e6.png" width="480" class="img_ev3q"><p>ref:</p><ul><li><p><a href="https://www.electronjs.org/docs/latest/api/structures/ipc-main-event" target="_blank" rel="noopener noreferrer">IpcMainEvent Object extends <code>Event</code> | Electron</a></p></li><li><p><a href="https://www.electronjs.org/docs/latest/api/ipc-renderer" target="_blank" rel="noopener noreferrer">ipcRenderer | Electron</a></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="hwo-to-use-preloadts">hwo to use <code>preload.ts</code><a class="hash-link" href="#hwo-to-use-preloadts" title="标题的直接链接">​</a></h2><p>ref:</p><ul><li><a href="https://stackoverflow.com/questions/49076033/using-typescript-in-electrons-preload-scripts" target="_blank" rel="noopener noreferrer">Using typescript in Electron&#x27;s preload scripts - Stack Overflow</a></li></ul><p>suppose:</p><div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-yaml codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">MAIN</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/electron/main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">RENDERER</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/renderer/index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">PRELOAD_TS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/electron/preload.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">PRELOAD_JS</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> src/electron/preload.js</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">RUN_MAIN</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> electron MAIN</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> or like</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token key atrule" style="color:#00a4db">RUN_RENDERER</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> webpack serve </span><span class="token punctuation" style="color:#393A34">-</span><span class="token punctuation" style="color:#393A34">-</span><span class="token plain">config WEBPACK_DEV_CONFIG_RENDERER.js</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> or like</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-preload-script-wont-run-if-we-just-start-the-main-process">the <code>preload</code> script won&#x27;t run if we just start the main process<a class="hash-link" href="#the-preload-script-wont-run-if-we-just-start-the-main-process" title="标题的直接链接">​</a></h3><p>First, if we only run <code>electron MAIN</code>
or <code>electron -r ts-node/register/transpile-only MAIN</code> (ts support), the electron
window would run successfully no matter we pointed a <code>preload</code> file or not since
the file would only run just before the renderer process, i.e. after the main
process and separate.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="its-ok-when-we-just-use-preloadjs">it&#x27;s ok when we just use <code>preload.js</code><a class="hash-link" href="#its-ok-when-we-just-use-preloadjs" title="标题的直接链接">​</a></h3><p>If we just use <code>preload.js</code>, then no matter we use webpack or not, the programme
would run well.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-about-using-a-preloadts">what about using a <code>preload.ts</code><a class="hash-link" href="#what-about-using-a-preloadts" title="标题的直接链接">​</a></h3><p>The main problem concerning with <code>preload.ts</code> is that when we use electron, we
are likely to use different pack method for main process and the renderer one,
and the core concept is whether the <code>preload.ts</code> had been compiled
into <code>preload.js</code> and executed by the renderer.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="remedy-1-the-tsc-solution">remedy 1, the <code>tsc</code> solution<a class="hash-link" href="#remedy-1-the-tsc-solution" title="标题的直接链接">​</a></h4><p>If we first created a <code>preload.ts</code> file and it doesn&#x27;t export anything to with
the main or renderer codes, then the only change we need to do is that to
add <code>tsc PRELOAD_TS &amp;&amp; </code> before the <code>RUN_RENDERER</code>.</p><p>It can be expected to see the <code>preload.ts</code> changed into <code>preload.js</code> and all the
things goes ok.</p><p>For example, we can write pure <code>ts</code> type of <code>preload</code>, and it in fact needs no
extra modification since the interface is perfect except a little dangerous
since we didn&#x27;t put constraint on the api request. More can be found refer
to: <a href="https://www.electronjs.org/docs/latest/tutorial/context-isolation#:~:text=over%20the%20bridge.-,security%20considerations" target="_blank" rel="noopener noreferrer">Security considerations</a></p><img loading="lazy" alt="picture 62" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640619986956-electron-howto-1ce7cdbe555ac69cf6f36e74efe332354d4bfda0fc47257f55efb8c46d629538.png" width="480" class="img_ev3q"><p>I do care about the safe problem if this is a huge app developed for commercial
use.</p><p>But If I write more apis, then it would drive me to separate my apis in another
file, and the renderer, as well as the main, would read from the file together.
At the same time, <code>tsc</code> would compile the <code>preload.ts</code> along with the separate
file to <code>.js</code>, then a <code>emit skipped</code> error may happen if the electron main to
read a <code>interface.ts</code> file but to find there exists both <code>interface.ts</code>
and <code>interface.js</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-remedy-the--electron-react-boilerplate-project">how to remedy the  <code>electron-react-boilerplate</code> project<a class="hash-link" href="#how-to-remedy-the--electron-react-boilerplate-project" title="标题的直接链接">​</a></h3><p>Dive into the source coe
of <a href="https://github.com/electron-react-boilerplate/electron-react-boilerplate#:~:text=electron-react-boilerplate%0A%20%20%0A%20%20%2F-,electron-react-boilerplate,-Public%20template" target="_blank" rel="noopener noreferrer">electron-react-boilerplate</a>
, we can know the programme startup flow under the development environment is as
the following:</p><div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/markshawn2020/docusaurus/edit/master/docs/coding/JS/Electron/electron-howto.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_vwxv"><span class="theme-last-updated">最后<!-- -->于 <b><time datetime="2022-07-26T02:51:23.000Z">2022年7月26日</time></b> <!-- -->更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docusaurus/docs/coding/JS/Electron/electron-bugfix"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">electron-bugfix</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docusaurus/docs/coding/JS/Electron/electron-prisma-sqlite-2"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">electron prisma sqlite 2</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#electron-best-practice" class="table-of-contents__link toc-highlight">electron best practice</a><ul><li><a href="#design-of-dependency-workflow" class="table-of-contents__link toc-highlight">design of dependency workflow</a></li><li><a href="#app-path-storing-db-log-etc" class="table-of-contents__link toc-highlight">app path, storing db, log, etc</a></li><li><a href="#log-into-file" class="table-of-contents__link toc-highlight">log into file</a></li></ul></li><li><a href="#electron-test" class="table-of-contents__link toc-highlight">electron test</a></li><li><a href="#sqlite-best-practice" class="table-of-contents__link toc-highlight">sqlite best practice</a><ul><li><a href="#dont-use-relative-path-as-sqlite-position" class="table-of-contents__link toc-highlight">don&#39;t use relative path as sqlite position</a></li></ul></li><li><a href="#log-electron" class="table-of-contents__link toc-highlight">log electron</a><ul><li><a href="#todo-idealog-color-configuration" class="table-of-contents__link toc-highlight">TODO: idealog color configuration</a></li></ul></li><li><a href="#build-for-windows-on-mac" class="table-of-contents__link toc-highlight">build for Windows on Mac</a></li><li><a href="#build-native-dependencies-and-for-multi-platforms" class="table-of-contents__link toc-highlight">build native dependencies and for multi platforms</a></li><li><a href="#custom-app-logo" class="table-of-contents__link toc-highlight">custom app logo</a><ul><li><a href="#a-good-start" class="table-of-contents__link toc-highlight">a good start</a></li><li><a href="#customize-icon-for-unpacked-app" class="table-of-contents__link toc-highlight">customize icon for unpacked app</a></li><li><a href="#square-icon" class="table-of-contents__link toc-highlight">square .icon</a></li></ul></li><li><a href="#electron-builder-files-map" class="table-of-contents__link toc-highlight">electron-builder <code>files</code> map</a></li><li><a href="#️️️-debug-binary-electron" class="table-of-contents__link toc-highlight">⭐️⭐️⭐️ debug binary electron</a></li><li><a href="#ipcrenderer-communication" class="table-of-contents__link toc-highlight"><code>ipcRenderer</code> communication</a></li><li><a href="#hwo-to-use-preloadts" class="table-of-contents__link toc-highlight">hwo to use <code>preload.ts</code></a><ul><li><a href="#the-preload-script-wont-run-if-we-just-start-the-main-process" class="table-of-contents__link toc-highlight">the <code>preload</code> script won&#39;t run if we just start the main process</a></li><li><a href="#its-ok-when-we-just-use-preloadjs" class="table-of-contents__link toc-highlight">it&#39;s ok when we just use <code>preload.js</code></a></li><li><a href="#what-about-using-a-preloadts" class="table-of-contents__link toc-highlight">what about using a <code>preload.ts</code></a></li><li><a href="#how-to-remedy-the--electron-react-boilerplate-project" class="table-of-contents__link toc-highlight">how to remedy the  <code>electron-react-boilerplate</code> project</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docusaurus/docs/index">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/docusaurus/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Docusaurus</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/category/guides" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docusaurus/assets/js/runtime~main.342ff705.js"></script>
<script src="/docusaurus/assets/js/main.f7bbc373.js"></script>
</body>
</html>