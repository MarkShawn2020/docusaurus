<!doctype html>
<html lang="zh-Hans" dir="ltr" class="blog-wrapper blog-tags-post-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-rc.1">
<link rel="alternate" type="application/rss+xml" href="/keeps-learning/blog/rss.xml" title="南川笔记 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/keeps-learning/blog/atom.xml" title="南川笔记 Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QFQ00XLDNZ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-QFQ00XLDNZ",{anonymize_ip:!0})</script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><title data-rh="true">1 篇博文 含有标签「Webpack」 | 南川笔记</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://markshawn2020.github.io/keeps-learning/blog/tags/webpack"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" property="og:title" content="1 篇博文 含有标签「Webpack」 | 南川笔记"><meta data-rh="true" name="docusaurus_tag" content="blog_tags_posts"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_tags_posts"><link data-rh="true" rel="icon" href="/keeps-learning/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://markshawn2020.github.io/keeps-learning/blog/tags/webpack"><link data-rh="true" rel="alternate" href="https://markshawn2020.github.io/keeps-learning/blog/tags/webpack" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://markshawn2020.github.io/keeps-learning/blog/tags/webpack" hreflang="x-default"><link rel="stylesheet" href="/keeps-learning/assets/css/styles.6bbfa55a.css">
<link rel="preload" href="/keeps-learning/assets/js/runtime~main.7744715b.js" as="script">
<link rel="preload" href="/keeps-learning/assets/js/main.5f5c9a83.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/keeps-learning/"><div class="navbar__logo"><img src="/keeps-learning/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/keeps-learning/img/logo.svg" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">南川笔记</b></a><a class="navbar__item navbar__link" href="/keeps-learning/docs/">My Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/keeps-learning/blog/tags">My Blog</a><a class="navbar__item navbar__link" href="/keeps-learning/gallery">Gallery</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/markshawn2020/keeps-learning" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source Code<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">All Posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/07/11/archive/prose-I-am-me">札记 | 我与我周旋久，我亦是我</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/07/02/archive/dev-gaokao">编程 | 使用pandas研究高考志愿填报</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/06/16/archive/dev-gopro-2">编程 | GoPro 02: 玩转 OpenLab</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/06/11/archive/dev-gopro-1">编程 | GoPro 01: 全天候自动4K延时摄影</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/06/06/archive/dev-ios-automation">编程 | iOS 自动化实现王者荣耀一键换装</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/05/23/archive/dev-mp3-meta">编程 | 逼哥的音乐元数据修复</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/05/22/archive/evaluation-breo-dream6">评测 | Breo Dream6 按摩仪</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/05/15/archive/prose-is-not-easy">札记 | 须知，活好是很不容易的</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/05/14/archive/dev-voice2srt">编程 | 视频剪辑自动转写字幕</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/04/22/archive/research-mbti/mark_mbti">研究 | 基于MBTI的人生复盘与计划（上）</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/03/27/archive/prose-321-air-crash">札记 | 愿逝者安息生者坚强，你我迎风奔跑向阳而生</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/03/09/archive/dev-douban-renting">编程 | 北京租房系统设计、研究与经验 0.1.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/02/21/archive/ad-beike-hiring">推广 | 贝壳新业务VR全职开发招募</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/02/03/archive/prose-living">札记 | 2022，活着</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/02/02/archive/dev-linux">编程 | Linux 笔记</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/02/01/archive/prose-2022-begining">札记 | 关于近几年的一些感悟</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/01/23/archive/prose-engineer-cultivation">札记 | 一位工程师的自我修养（序）</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/01/20/archive/prose-first-job">札记 | 是的，我入职了</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2022/01/01/archive/prose-my-2021">札记 | 我的2021：混沌与洞见</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/keeps-learning/blog/2021/12/24/archive/dev-webpack">编程 | 记与Webpack十二小时的奋战</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>1 篇博文 含有标签「Webpack」</h1><a href="/keeps-learning/blog/tags">查看所有标签</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="title_f1Hy" itemprop="headline"><a itemprop="url" href="/keeps-learning/blog/2021/12/24/archive/dev-webpack">编程 | 记与Webpack十二小时的奋战</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2021-12-24T00:00:00.000Z" itemprop="datePublished">2021年12月24日</time> · <!-- -->阅读需 13 分钟</div></header><div class="markdown" itemprop="articleBody"><p>2021年12月24日</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="content">Content<a class="hash-link" href="#content" title="标题的直接链接">​</a></h2><p>这篇必须用中文记录，而且直到目前还没有完全解决，只实现了一个还可以接受的替代方案，背后还有一些东西没弄明白。</p><p>先直接说结论：</p><ol><li>如果所有的依赖包都是<code>commonjs</code>形式（使用<code>require</code>和<code>module.export</code>），子包的<code>package.json</code>中没有定义<code>type: &quot;module&quot;</code>，则webpack无论怎么写，基本都不会出错，直接运行<code>webpack --config xxx.webpack.config.js</code>即可</li><li>如果<code>xxx.config.js</code>文件中使用了<code>import xxx from xx</code>或者子包都是用的<code>type: &quot;module&quot;</code>，则在项目的<code>package.json</code>中定义一些<code>type: &quot;module&quot;</code>，也可以解决问题</li><li>如果出现了<code>commonjs</code>和<code>esm</code>混用的情况，则会报错，要么导致<code>Cannot use import statement outside a module</code>，要么导致<code>mjs</code>等等无法导入因为有<code>type: module</code>之类的问题，下面着重说一下在该种情况下的解决方案</li></ol><p>我碰到的问题就是，我直接clone的github上的两个boilerplate，一个是<code>electron-react-typescript-webpack-boilerplate</code>，还有一个是<a href="https://github.com/diego3g/electron-typescript-react#:~:text=electron-typescript-react" target="_blank" rel="noopener noreferrer">electron-typescript-react</a>，这两个boilerplate虽然配置有些差异，而且一个用到了<code>babel</code>一个没用，但是共同点就是<code>webpack.config.js</code>中都没有使用<code>import</code>语法，<code>webpack</code>的所有依赖也都是<code>commonjs</code>。</p><p>而我为了将<code>markdown</code>文件在前端渲染出来，虽然我可以直接使用<code>marked</code>或者<code>react-markdown</code>这类package，但是基于以前<code>nextjs | gatsby</code>等框架的经验，直接基于<code>webpack</code>进行<code>markdown</code>解析体验会比较好（毕竟两个项目都用上<code>webpack</code>了）。</p><p>但是问题来了，我在<code>webpack</code>官网中找到加载<code>markdown</code>相关的<code>loaders</code>的 <a href="https://webpack.js.org/loaders/remark-loader/#inspiration" target="_blank" rel="noopener noreferrer">remark-loader | webpack</a> 章节时，实际使用发现<code>remark-html</code>是<code>esm</code>，没法直接用，我的<code>webpack</code>会报错。</p><p>接着我就经历了12个小时的奋斗，尝试了几乎所有能找到的方案，从最基础的改<code>type: &quot;module&quot;</code>，到用上<code>babel-register</code>，甚至详细去读了<code>webpack</code>、<code>babel</code>的相关内容，最后不得不都以失败告终。其中应该说最有影响力、提供解决方案最多（然而最终都失败）的帖子应该是下面这个：</p><ul><li><a href="https://stackoverflow.com/questions/31903692/how-can-i-use-es6-in-webpack-config-js" target="_blank" rel="noopener noreferrer">How can I use ES6 in webpack.config.js? - Stack Overflow</a></li></ul><p>问题说的很清楚，就是要在<code>webpack.config.js</code>中使用<code>ES6</code>。</p><p>但答案都不OK，最终，我在万念俱灰无数次之后，偶然在 <a href="https://github.com/vercel/next.js/discussions/27758" target="_blank" rel="noopener noreferrer">Bug at render-markdown stage of tutorial: Must use import to load ES Module · Discussion #27758 · vercel/next.js</a> 这个帖子里找到了一句话：<code>npm install remark@13 remark-html@13</code>，凭着经验，我一下就知道是怎么回事了，因为前两天我刚刚与万恶的<code>webstorm</code>不支持<code>tailwindcss</code>最新版最终不得不安装<code>tailwindcss@2.0.1-compat</code>做了同样艰苦的斗争！</p><img loading="lazy" alt="picture 5" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640346360145-webpack-bugfix-349711dd9f694e145b5dc4a1ddae42e2955043d9a23747857b50d1423368dd9f.png" width="480" class="img_ev3q"><p>果然，安装指定的版本后，项目终于成功运行：</p><img loading="lazy" alt="picture 6" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640346477725-webpack-bugfix-7d4cd572dc5ec9fe5ad511c4156c56e047cbe30184b88b8c95601c1d21b1b02e.png" width="480" class="img_ev3q"><p>至此，所有与<code>webpack</code>的斗争，应该说告一段落了，不然，我下一个更艰苦卓绝的打算，可能就是去看<code>nextjs</code>之类重型框架的源码，剖析它们是怎么高大上地使用<code>webpack</code>了。。</p><p>所以，目前，我可以确定的就是，只要保证所有<code>webpack</code>依赖的库都是<code>commonjs</code>，就可以不借助<code>babel</code>使项目运行，毕竟当一个前端项目需要用上<code>babel</code>的时候，它肯定就已经是另一个项目了，于是，一键DELETE恢复世界清净。</p><img loading="lazy" alt="picture 9" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640347058731-webpack-bugfix-901426db9195c9d0a7ec92ef0370f3a94d57f35b9b78808b330f4929e3341574.png" width="480" class="img_ev3q"><p>不过事实上，就像我开头说的，我clone了两个项目，其中一个用了babel，用于转换<code>jsx</code>之类的文件的，它是基于<code>electron-forge</code>的，为了弄清楚当时的报错我还特意去看了这个库，说实话也没怎么弄明白。它的这个<code>boilerplate</code>对我最大的启发，应该是写了一个标准的<code>main</code>和<code>renderer</code>之间通信的接口，即：</p><ol><li>main中暴露api给renderer使用的接口定义</li></ol><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// src/@types/bridge.d.ts </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> api </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;electron/bridge&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">declare</span><span class="token plain"> global </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// eslint-disable-next-line</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">Window</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Main</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li>main中对api使用的收发封装</li></ol><div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// electron/bridge.ts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> contextBridge</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ipcRenderer </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;electron&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> api </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * Here you can expose functions to the renderer process</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * so they can interact with the main (electron) side</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * without security problems.</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   *</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * The function below can accessed using `window.Main.sendMessage`</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">sendMessage</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">message</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ipcRenderer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">send</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;message&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">/**</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   * Provide an easier way to listen to events</span><br></span><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">   */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function-variable function" style="color:#d73a49">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">channel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> callback</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">Function</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ipcRenderer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">on</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">channel</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">_</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">callback</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">data</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">contextBridge</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">exposeInMainWorld</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;Main&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> api</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>这两个文件，包括main和render程序中如何使用这两个文件的写法对我还是有很好的指导作用的，至少electron官网上对typescript的范式介绍比较少，这就需要从这些boilerplate中寻找指点。</p><p>但除此之外，这个boilerplate对我的意义就不大了，而且，我也不怎么看得懂它给定的几个<code>scripts</code>，其实无法就是开发版、生产版、运行、打包与测试的不同命令，但是被他搞的有点负责，相比较之下，另一个boilerplate就很好，清晰明白，也有可能上半年我在学习electron的时候正好用的就是第二个boilerplate，但无论怎样，确实第二个更好。</p><img loading="lazy" alt="picture 10" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640347712904-webpack-bugfix-5b369e0dff7ff239ccac2debcdc0a1dbf626a177b96e8f07b9fb9cf1e9ef977c.png" width="480" class="img_ev3q"><hr><img loading="lazy" alt="picture 11" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640347790778-webpack-bugfix-dec8b0f034c1fea196744e1f5f4d8772efad854d0a2d28d7858995617024a57e.png" width="480" class="img_ev3q"><p>但为了确信这一点（2比1好），我又重新去确认了一下github的star数，结果，并不是这样的，第一个boilerplate的star有1.2k，而第二个只有176，好家伙……我的直觉真不靠谱。</p><p>不过这也解释地通，因为第一个是叫<code>electron-typescript-react</code>，第二个叫<code>electron-react-typescript-webpack-boilerplate</code>，表面上后者是前者的具化，因为名词更多。</p><p>但事实上，恰恰相反，在<code>electron-typescript-react</code>中反而既有<code>webpack</code>也有<code>babel</code>，其实比另一个涉及的东西还有多……从这个角度想，第一个boilerplate星多，应该至少归结于三个点：</p><ol><li>名字短</li><li>加了<code>babel</code>，让使用者有了更多发挥的空间</li><li><code>bridge</code>的接口写的棒，对使用者有更大的价值</li><li>...</li></ol><p>Anyway，这大概就是关于目前这个问题的所有思考，和两个boilerplate带给我的启发。</p><p>接下来，才是工作的重头戏，那就是手上工具顺了，就要立即投身到业务实现上了。</p><p>但仍然，我开头说的还有一些问题是没有解决的，罗列如下：</p><ol><li>为什么<code>webpack</code>官网的所有<code>loader</code>的配置都是<code>import</code>导入的，难道他们所有的dependencies都是esm吗？</li><li>有可能不是，因为我还看到他们的有些loader可以使用<code>type: &quot;auto&quot;</code>这种配置，应该就是自动对多种type的js采取不同的策略智能打包的意思，但这个可以作用于<code>config.js</code>的抬头吗？好像不可以吧，因为我看他们是用在<code>rules</code>里的。</li><li>肯定存在很多<code>commonjs</code>和<code>esm</code>混用的项目的，如果不引入<code>babel</code>，<code>webpack</code>是否可以有策略正常运行呢？目前，他们都是基于<code>babel</code>的吗？</li><li>如果是基于<code>babel</code>，我认为我之前尝试装那么多<code>babel</code>依赖，应该也可以正常运行啊，为什么就不能奏效呢？</li></ol><p>关于第三点，我突然想到我上半年也写过脚本，翻出来看了一下：</p><img loading="lazy" alt="picture 12" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640348790672-webpack-bugfix-66129064c7e8a8c55c2161aad0bcce67f18e484b1cf913921f14bd01688a3542.png" width="480" class="img_ev3q"><p>可以看到，确实是要用<code>babel_register</code>进行子程序注册的，并且我也确实是用<code>import</code>进行导包的：</p><img loading="lazy" alt="picture 13" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640348883256-webpack-bugfix-a0039a63671200450ee7bc85582444eecf757b3c9393f8bd3443e2b72b79dedd.png" width="480" class="img_ev3q"><p>人老了啊，记性不行了，当时应该研究这些东西也花了一星期的，结果都一点印象没了，幸好好记性不如烂笔头，整理了当时的代码库。再回想开头看的那个关于<code>babel_register</code>的解决方案，内心突然就有些豁然开朗了：</p><img loading="lazy" alt="picture 14" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640349025625-webpack-bugfix-045d3c71ca84950c4a03136ad85db57f3652e3aa1f0600b59ebcdfd8eaf8c66f.png" width="480" class="img_ev3q"><p>不过呢，至少这个项目，我应该暂时不需要了hhh，如果需要，到时候<code>yarn add</code>一顿乱装，加个<code>babel-register</code>脚本，改一下启动命令行，应该就行了，hhh，肯定不会像今天这样头疼了。</p><p>那就暂时先这样，对该问题的记录到此为止。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="former-record">Former Record<a class="hash-link" href="#former-record" title="标题的直接链接">​</a></h2><blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="problem-syntaxerror-cannot-use-import-statement-outside-a-module">[Problem]<!-- --> SyntaxError: Cannot use import statement outside a module<a class="hash-link" href="#problem-syntaxerror-cannot-use-import-statement-outside-a-module" title="标题的直接链接">​</a></h3><p>This discussion is very close to what I happened to, however they gave no solution, except pointed out that there may be some package using <code>es</code> which seems <strong>not proper for webpack</strong>, and inspired me to have a check at <a href="#the-target-package-of-remark-html-i-wanted-to-import">the target package</a>  I wanted to import as official webpack suggested me to.</p><ul><li><a href="https://stackoverflow.com/questions/70114861/why-does-error-syntaxerror-cannot-use-import-statement-outside-a-module-when" target="_blank" rel="noopener noreferrer">javascript - Why does Error &#x27;SyntaxError: Cannot use import statement outside a module &#x27; when I try to use ES Modules? - Stack Overflow</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-target-package-of-remark-html-i-wanted-to-import">The target package of <code>remark-html</code> I wanted to import<a class="hash-link" href="#the-target-package-of-remark-html-i-wanted-to-import" title="标题的直接链接">​</a></h3><ul><li><a href="https://webpack.js.org/loaders/remark-loader/#root" target="_blank" rel="noopener noreferrer">remark-loader | webpack</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="failed-solution-of-babel-node">[Failed]<!-- --> Solution of <code>babel-node</code><a class="hash-link" href="#failed-solution-of-babel-node" title="标题的直接链接">​</a></h3><p>It seems that <code>babel-node</code> is a possible solution to this problem, since it when I installed it, it automatically detected what&#x27;s going wrong of all my webpack loaders.</p><img loading="lazy" alt="picture 1" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640327908025-webpack-bugfix-51cf4a831368a2ef7d3cf8957e88c6c5f9528ec63aa21ab93ff4602781cdc6cd.png" width="480" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="failed-solution-of-babelregister">[Failed]<!-- --> Solution of <code>@babel/register</code><a class="hash-link" href="#failed-solution-of-babelregister" title="标题的直接链接">​</a></h3><ul><li><a href="https://stackoverflow.com/questions/31903692/how-can-i-use-es6-in-webpack-config-js" target="_blank" rel="noopener noreferrer">How can I use ES6 in webpack.config.js? - Stack Overflow</a></li></ul></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="真正唯一的收获">真正唯一的收获<a class="hash-link" href="#真正唯一的收获" title="标题的直接链接">​</a></h2><p>前段时间有个字节的小姐姐，和我表述想转码的意愿，聊下来觉得前端对她可以一试，毕竟目前各种开发岗位里前端是相对来说最容易上手的了……</p><p>但是！</p><p>这说的只是十二十年前纯粹用<code>html + css + jquery</code> 或者 <code>php</code>的时代！</p><p>现在，前端技术突飞猛进，各种范式层出不穷，变得越来越复杂了，三大框架<code>AngularJS | React | Vue</code>就不说了，<code>webpack</code>和<code>babel</code>绝对能让大厂的前端开发掉一层皮……</p><p>但anyway，如果不论这些，平时写写前端真地能让人心情大好，获得感十足，用一位朋友对开发的态度来说：“平时自己写些玩玩挺好的，当做工作就太无聊了”，确实如是~</p><p>保持学习，保持热爱！</p><img loading="lazy" alt="picture 15" src="https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/1640349694440-webpack-bugfix-7adf1882ddf381568cee583516f84f77d56237f255c73a5bcceb153755794696.png" width="480" class="img_ev3q"><p>reference:</p><ul><li><a href="https://blog.logrocket.com/transpile-es-modules-with-webpack-node-js/" target="_blank" rel="noopener noreferrer">How to transpile ES modules with webpack and Node.js - LogRocket Blog</a></li></ul><ul><li><a href="https://stackoverflow.com/questions/31903692/how-can-i-use-es6-in-webpack-config-js" target="_blank" rel="noopener noreferrer">How can I use ES6 in webpack.config.js? - Stack Overflow</a></li></ul><ul><li><p><a href="https://github.com/diego3g/electron-typescript-react" target="_blank" rel="noopener noreferrer">diego3g/electron-typescript-react: An Electron boilerplate including TypeScript, React, Jest and ESLint.</a></p></li><li><p><a href="https://github.com/Devtography/electron-react-typescript-webpack-boilerplate" target="_blank" rel="noopener noreferrer">Devtography/electron-react-typescript-webpack-boilerplate: Pre-configured boilerplate for Electron + React + TypeScript + Webpack</a></p></li><li><p><a href="https://webpack.js.org/loaders/remark-loader/#inspiration" target="_blank" rel="noopener noreferrer">remark-loader | webpack</a></p></li><li><p><a href="https://github.com/vercel/next.js/discussions/27758" target="_blank" rel="noopener noreferrer">Bug at render-markdown stage of tutorial: Must use import to load ES Module · Discussion #27758 · vercel/next.js</a></p></li><li><p><a href="https://www.electronforge.io/templates/typescript-+-webpack-template" target="_blank" rel="noopener noreferrer">TypeScript + Webpack - Electron Forge</a></p></li><li><p><a href="https://www.electronjs.org/zh/docs/latest/api/ipc-main" target="_blank" rel="noopener noreferrer">ipcMain | Electron</a></p></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><b>标签：</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/keeps-learning/blog/tags/开发笔记">开发笔记</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/keeps-learning/blog/tags/webpack">Webpack</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/keeps-learning/blog/tags/前端">前端</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="博文列表分页导航"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/keeps-learning/docs">Docs</a></li><li class="footer__item"><a class="footer__link-item" href="/keeps-learning/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Docusaurus</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://docusaurus.io/docs/category/guides" target="_blank" rel="noopener noreferrer" class="footer__link-item">Documentation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/keeps-learning/assets/js/runtime~main.7744715b.js"></script>
<script src="/keeps-learning/assets/js/main.5f5c9a83.js"></script>
</body>
</html>