"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4166],{3905:(e,a,r)=>{r.d(a,{Zo:()=>d,kt:()=>u});var t=r(67294);function n(e,a,r){return a in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function i(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),r.push.apply(r,t)}return r}function s(e){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?i(Object(r),!0).forEach((function(a){n(e,a,r[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))}))}return e}function l(e,a){if(null==e)return{};var r,t,n=function(e,a){if(null==e)return{};var r,t,n={},i=Object.keys(e);for(t=0;t<i.length;t++)r=i[t],a.indexOf(r)>=0||(n[r]=e[r]);return n}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(t=0;t<i.length;t++)r=i[t],a.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var o=t.createContext({}),c=function(e){var a=t.useContext(o),r=a;return e&&(r="function"==typeof e?e(a):s(s({},a),e)),r},d=function(e){var a=c(e.components);return t.createElement(o.Provider,{value:a},e.children)},m={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},p=t.forwardRef((function(e,a){var r=e.components,n=e.mdxType,i=e.originalType,o=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=c(r),u=n,k=p["".concat(o,".").concat(u)]||p[u]||m[u]||i;return r?t.createElement(k,s(s({ref:a},d),{},{components:r})):t.createElement(k,s({ref:a},d))}));function u(e,a){var r=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var i=r.length,s=new Array(i);s[0]=p;var l={};for(var o in a)hasOwnProperty.call(a,o)&&(l[o]=a[o]);l.originalType=e,l.mdxType="string"==typeof e?e:n,s[1]=l;for(var c=2;c<i;c++)s[c]=r[c];return t.createElement.apply(null,s)}return t.createElement.apply(null,r)}p.displayName="MDXCreateElement"},96833:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>h,contentTitle:()=>u,default:()=>b,frontMatter:()=>p,metadata:()=>k,toc:()=>v});var t=r(3905),n=Object.defineProperty,i=Object.defineProperties,s=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,d=(e,a,r)=>a in e?n(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r,m=(e,a)=>{for(var r in a||(a={}))o.call(a,r)&&d(e,r,a[r]);if(l)for(var r of l(a))c.call(a,r)&&d(e,r,a[r]);return e};const p={},u="Manual/bugfix of compiling arpara hmdservice on AOSP 10",k={unversionedId:"AndroidFramework/hmdservice/TaskB1-hmdservice-compile/how-to-compile-arpara-hmdservice-on-AOSP10",id:"AndroidFramework/hmdservice/TaskB1-hmdservice-compile/how-to-compile-arpara-hmdservice-on-AOSP10",title:"Manual/bugfix of compiling arpara hmdservice on AOSP 10",description:"\u4e00\u4e9b\u5df2\u77e5\u7684\u95ee\u9898\uff0c\u4e3b\u8981\u96c6\u4e2d\u5728\u73af\u5883\u914d\u7f6e\u4e0e\u8bed\u6cd5\u5c42\u9762\uff0c\u5b9e\u9645\u6548\u679c\u8fd8\u672a\u77e5\uff0cusb\u63a5\u53e3\u53d8\u52a8\u7684\u4e8b\u5219\u503c\u5f97\u6ce8\u610f",source:"@site/library/docs/AndroidFramework/hmdservice/TaskB1-hmdservice-compile/how-to-compile-arpara-hmdservice-on-AOSP10.md",sourceDirName:"AndroidFramework/hmdservice/TaskB1-hmdservice-compile",slug:"/AndroidFramework/hmdservice/TaskB1-hmdservice-compile/how-to-compile-arpara-hmdservice-on-AOSP10",permalink:"/docs/AndroidFramework/hmdservice/TaskB1-hmdservice-compile/how-to-compile-arpara-hmdservice-on-AOSP10",draft:!1,editUrl:"https://github.com/markshawn2020/keeps-learning/edit/master/library/docs/AndroidFramework/hmdservice/TaskB1-hmdservice-compile/how-to-compile-arpara-hmdservice-on-AOSP10.md",tags:[],version:"current",lastUpdatedAt:1659094879,formattedLastUpdatedAt:"2022\u5e747\u670829\u65e5",frontMatter:{},sidebar:"defaultSidebar",previous:{title:"frameworks howto",permalink:"/docs/AndroidFramework/frameworks-howto"},next:{title:"native service integration howto",permalink:"/docs/AndroidFramework/hmdservice/TaskB2-hmdservice-integration/native-service-integration-howto"}},h={},v=[{value:"\u73af\u5883\u8981\u6c42",id:"\u73af\u5883\u8981\u6c42",level:2},{value:"\u5168\u5c40\u53d8\u91cf\uff08\u672c\u5730\u793a\u4f8b\uff09",id:"\u5168\u5c40\u53d8\u91cf\u672c\u5730\u793a\u4f8b",level:2},{value:"\u7f16\u8bd1\u603b\u89c8",id:"\u7f16\u8bd1\u603b\u89c8",level:2},{value:"step 1. \u521d\u59cb\u5316\u9879\u76ee",id:"step-1-\u521d\u59cb\u5316\u9879\u76ee",level:2},{value:"fix 1. <code>glm</code> \u8def\u5f84\u4fee\u6b63",id:"fix-1-glm-\u8def\u5f84\u4fee\u6b63",level:3},{value:"\u9879\u76ee\u62f7\u8d1d",id:"\u9879\u76ee\u62f7\u8d1d",level:3},{value:"<code>Android.mk</code> \u914d\u7f6e",id:"androidmk-\u914d\u7f6e",level:3},{value:"fix 2. <code>libusbhost</code>",id:"fix-2-libusbhost",level:4},{value:"fix 3. <code>LOCAL_CFLAGS</code>",id:"fix-3-local_cflags",level:4},{value:"Android.mk \u4e8b\u5148\u7f16\u8f91\u7684\u91cd\u8981\u6027",id:"androidmk-\u4e8b\u5148\u7f16\u8f91\u7684\u91cd\u8981\u6027",level:4},{value:"step 2. usb \u63a5\u53e3\u4fee\u590d",id:"step-2-usb-\u63a5\u53e3\u4fee\u590d",level:2},{value:"\u4fee\u590d\u9700\u8981\u65b0\u589e<code>timeout</code>\u7684\u4e09\u4e2a\u63a5\u53e3<code>manufacture | product | serial</code>\uff0c\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u76ee\u524d\u6539\u6210\u4e865000",id:"\u4fee\u590d\u9700\u8981\u65b0\u589etimeout\u7684\u4e09\u4e2a\u63a5\u53e3manufacture--product--serial\u5355\u4f4d\u662f\u6beb\u79d2\u76ee\u524d\u6539\u6210\u4e865000",level:3},{value:"\u5220\u9664<code>*name</code>\u6ca1\u6709\u7528\u5230\uff0c\u63a5\u53e3\u4e5f\u53d8\u4e86\u7684\u4e00\u53e5\u4ee3\u7801",id:"\u5220\u9664name\u6ca1\u6709\u7528\u5230\u63a5\u53e3\u4e5f\u53d8\u4e86\u7684\u4e00\u53e5\u4ee3\u7801",level:3},{value:"step 3. \u4ee3\u7801\u8bed\u6cd5\u4fee\u590d",id:"step-3-\u4ee3\u7801\u8bed\u6cd5\u4fee\u590d",level:2},{value:"\u2705 <code>fall through</code>",id:"-fall-through",level:3},{value:"\u2705 \u5220\u9664\u7a7a\u6307\u9488\u95ee\u9898\uff0c\u8f6c\u4e3a\u8d4b\u503c\u4e3a\u7a7a\u6307\u9488",id:"-\u5220\u9664\u7a7a\u6307\u9488\u95ee\u9898\u8f6c\u4e3a\u8d4b\u503c\u4e3a\u7a7a\u6307\u9488",level:3},{value:"\u2705 \u5176\u4ed6\u4e00\u4e9b\u7c7b\u578b\u8f6c\u6362",id:"-\u5176\u4ed6\u4e00\u4e9b\u7c7b\u578b\u8f6c\u6362",level:3},{value:"\u7f16\u8bd1\u6210\u529f\u6548\u679c",id:"\u7f16\u8bd1\u6210\u529f\u6548\u679c",level:2},{value:"\u2728 build success of <code>libhmdservice</code>",id:"-build-success-of-libhmdservice",level:3},{value:"\u2728\u2728 build success of <code>hmdservice</code>",id:"-build-success-of-hmdservice",level:3},{value:"\u5f15\u7533\u9605\u8bfb/\u5176\u4ed6\u5206\u6790",id:"\u5f15\u7533\u9605\u8bfb\u5176\u4ed6\u5206\u6790",level:2},{value:"translate <code>Android.mk</code>",id:"translate-androidmk",level:3},{value:"\u2705 <code>Android.bp: Path is outside directory</code>",id:"-androidbp-path-is-outside-directory",level:3},{value:"\u2705 <code>error: frameworks/native/services/hmdservice/service: MODULE.TARGET.SHARED_LIBRARIES.libhmdservice already defined by frameworks/native/services/hmdservice/service.</code>",id:"-error-frameworksnativeserviceshmdserviceservice-moduletargetshared_librarieslibhmdservice-already-defined-by-frameworksnativeserviceshmdserviceservice",level:3},{value:"\u2705 <code>fatal error: &#39;usbhost/usbhost.h&#39; file not found</code>",id:"-fatal-error-usbhostusbhosth-file-not-found",level:3},{value:"usb cover progress",id:"usb-cover-progress",level:3},{value:"\u2705 <code>error: no matching function for call to &#39;usb_device_get_manufacturer_name&#39;</code>",id:"-error-no-matching-function-for-call-to-usb_device_get_manufacturer_name",level:4},{value:"\u2705 <code>error: no matching function for call to &#39;usb_device_get_string&#39;</code>",id:"-error-no-matching-function-for-call-to-usb_device_get_string",level:4},{value:"\u2705 <code>error: unknown type name &#39;usb_device&#39;; did you mean &#39;UsbDevice&#39;?</code>",id:"-error-unknown-type-name-usb_device-did-you-mean-usbdevice",level:3},{value:"\u2705 \u53d8\u91cf\u6ca1\u6709\u4f7f\u7528\u7684\u60c5\u51b5\u4e0e\u624b\u52a8\u4fee\u590d\u8fc7\u7a0b\uff08\u653e\u5f03\uff0c\u540e\u6765\u76f4\u63a5\u914dmk\u4e86\uff09",id:"-\u53d8\u91cf\u6ca1\u6709\u4f7f\u7528\u7684\u60c5\u51b5\u4e0e\u624b\u52a8\u4fee\u590d\u8fc7\u7a0b\u653e\u5f03\u540e\u6765\u76f4\u63a5\u914dmk\u4e86",level:3},{value:"\u2705 <code>FAILED: ninja: &#39;frameworks/native/services/hmdservice/service/frameworks/native/services/hmdservice/service/common/IHmdServer.cpp&#39;, needed by &#39;out/target/product/generic_arm64/obj/SHARED_LIBRARIES/libhmdservice_intermediates/frameworks/native/services/hmdservice/service/common/IHmdServer.o&#39;, missing and no known rule to make it</code>",id:"-failed-ninja-frameworksnativeserviceshmdserviceserviceframeworksnativeserviceshmdserviceservicecommonihmdservercpp-needed-by-outtargetproductgeneric_arm64objshared_librarieslibhmdservice_intermediatesframeworksnativeserviceshmdserviceservicecommonihmdservero-missing-and-no-known-rule-to-make-it",level:3}],f={toc:v};function b(e){var a,r=e,{components:n}=r,d=((e,a)=>{var r={};for(var t in e)o.call(e,t)&&a.indexOf(t)<0&&(r[t]=e[t]);if(null!=e&&l)for(var t of l(e))a.indexOf(t)<0&&c.call(e,t)&&(r[t]=e[t]);return r})(r,["components"]);return(0,t.kt)("wrapper",(a=m(m({},f),d),i(a,s({components:n,mdxType:"MDXLayout"}))),(0,t.kt)("h1",m({},{id:"manualbugfix-of-compiling-arpara-hmdservice-on-aosp-10"}),"Manual/bugfix of compiling arpara hmdservice on AOSP 10"),(0,t.kt)("blockquote",null,(0,t.kt)("p",{parentName:"blockquote"},"\u4e00\u4e9b\u5df2\u77e5\u7684\u95ee\u9898\uff0c\u4e3b\u8981\u96c6\u4e2d\u5728\u73af\u5883\u914d\u7f6e\u4e0e\u8bed\u6cd5\u5c42\u9762\uff0c\u5b9e\u9645\u6548\u679c\u8fd8\u672a\u77e5\uff0cusb\u63a5\u53e3\u53d8\u52a8\u7684\u4e8b\u5219\u503c\u5f97\u6ce8\u610f")),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E7%8E%AF%E5%A2%83%E8%A6%81%E6%B1%82"}),"\u73af\u5883\u8981\u6c42")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E6%9C%AC%E5%9C%B0%E7%A4%BA%E4%BE%8B"}),"\u5168\u5c40\u53d8\u91cf\uff08\u672c\u5730\u793a\u4f8b\uff09")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E7%BC%96%E8%AF%91%E6%80%BB%E8%A7%88"}),"\u7f16\u8bd1\u603b\u89c8")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#step-1-%E5%88%9D%E5%A7%8B%E5%8C%96%E9%A1%B9%E7%9B%AE"}),"step 1. \u521d\u59cb\u5316\u9879\u76ee"),(0,t.kt)("ol",{parentName:"li"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#fix-1-glm-%E8%B7%AF%E5%BE%84%E4%BF%AE%E6%AD%A3"}),"fix 1. ",(0,t.kt)("inlineCode",{parentName:"a"},"glm")," \u8def\u5f84\u4fee\u6b63")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E9%A1%B9%E7%9B%AE%E6%8B%B7%E8%B4%9D"}),"\u9879\u76ee\u62f7\u8d1d")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#androidmk-%E9%85%8D%E7%BD%AE"}),(0,t.kt)("inlineCode",{parentName:"a"},"Android.mk")," \u914d\u7f6e"),(0,t.kt)("ol",{parentName:"li"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#fix-2-libusbhost"}),"fix 2. ",(0,t.kt)("inlineCode",{parentName:"a"},"libusbhost"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#fix-3-local_cflags"}),"fix 3. ",(0,t.kt)("inlineCode",{parentName:"a"},"LOCAL_CFLAGS"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#androidmk-%E4%BA%8B%E5%85%88%E7%BC%96%E8%BE%91%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7"}),"Android.mk \u4e8b\u5148\u7f16\u8f91\u7684\u91cd\u8981\u6027")))))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#step-2-usb-%E6%8E%A5%E5%8F%A3%E4%BF%AE%E5%A4%8D"}),"step 2. usb \u63a5\u53e3\u4fee\u590d"),(0,t.kt)("ol",{parentName:"li"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E4%BF%AE%E5%A4%8D%E9%9C%80%E8%A6%81%E6%96%B0%E5%A2%9Etimeout%E7%9A%84%E4%B8%89%E4%B8%AA%E6%8E%A5%E5%8F%A3manufacture--product--serial%E5%8D%95%E4%BD%8D%E6%98%AF%E6%AF%AB%E7%A7%92%E7%9B%AE%E5%89%8D%E6%94%B9%E6%88%90%E4%BA%865000"}),"\u4fee\u590d\u9700\u8981\u65b0\u589e",(0,t.kt)("inlineCode",{parentName:"a"},"timeout"),"\u7684\u4e09\u4e2a\u63a5\u53e3",(0,t.kt)("inlineCode",{parentName:"a"},"manufacture | product | serial"),"\uff0c\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u76ee\u524d\u6539\u6210\u4e865000")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E5%88%A0%E9%99%A4name%E6%B2%A1%E6%9C%89%E7%94%A8%E5%88%B0%E6%8E%A5%E5%8F%A3%E4%B9%9F%E5%8F%98%E4%BA%86%E7%9A%84%E4%B8%80%E5%8F%A5%E4%BB%A3%E7%A0%81"}),"\u5220\u9664",(0,t.kt)("inlineCode",{parentName:"a"},"*name"),"\u6ca1\u6709\u7528\u5230\uff0c\u63a5\u53e3\u4e5f\u53d8\u4e86\u7684\u4e00\u53e5\u4ee3\u7801")))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#step-3-%E4%BB%A3%E7%A0%81%E8%AF%AD%E6%B3%95%E4%BF%AE%E5%A4%8D"}),"step 3. \u4ee3\u7801\u8bed\u6cd5\u4fee\u590d"),(0,t.kt)("ol",{parentName:"li"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-fall-through"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"fall through"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-%E5%88%A0%E9%99%A4%E7%A9%BA%E6%8C%87%E9%92%88%E9%97%AE%E9%A2%98%E8%BD%AC%E4%B8%BA%E8%B5%8B%E5%80%BC%E4%B8%BA%E7%A9%BA%E6%8C%87%E9%92%88"}),"\u2705 \u5220\u9664\u7a7a\u6307\u9488\u95ee\u9898\uff0c\u8f6c\u4e3a\u8d4b\u503c\u4e3a\u7a7a\u6307\u9488")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-%E5%85%B6%E4%BB%96%E4%B8%80%E4%BA%9B%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"}),"\u2705 \u5176\u4ed6\u4e00\u4e9b\u7c7b\u578b\u8f6c\u6362")))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E7%BC%96%E8%AF%91%E6%88%90%E5%8A%9F%E6%95%88%E6%9E%9C"}),"\u7f16\u8bd1\u6210\u529f\u6548\u679c"),(0,t.kt)("ol",{parentName:"li"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#sparkles-build-success-of-libhmdservice"}),"\u2728 build success of ",(0,t.kt)("inlineCode",{parentName:"a"},"libhmdservice"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#sparklessparkles-build-success-of-hmdservice"}),"\u2728\u2728 build success of ",(0,t.kt)("inlineCode",{parentName:"a"},"hmdservice"))))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#%E5%BC%95%E7%94%B3%E9%98%85%E8%AF%BB%E5%85%B6%E4%BB%96%E5%88%86%E6%9E%90"}),"\u5f15\u7533\u9605\u8bfb/\u5176\u4ed6\u5206\u6790"),(0,t.kt)("ol",{parentName:"li"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#translate-androidmk"}),"translate ",(0,t.kt)("inlineCode",{parentName:"a"},"Android.mk"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-androidbp-path-is-outside-directory"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"Android.bp: Path is outside directory"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-error-frameworksnativeserviceshmdserviceservice-moduletargetshared_librarieslibhmdservice-already-defined-by-frameworksnativeserviceshmdserviceservice"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"error: frameworks/native/services/hmdservice/service: MODULE.TARGET.SHARED_LIBRARIES.libhmdservice already defined by frameworks/native/services/hmdservice/service."))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-fatal-error-usbhostusbhosth-file-not-found"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"fatal error: 'usbhost/usbhost.h' file not found"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#usb-cover-progress"}),"usb cover progress"),(0,t.kt)("ol",{parentName:"li"},(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-error-no-matching-function-for-call-to-usb_device_get_manufacturer_name"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"error: no matching function for call to 'usb_device_get_manufacturer_name'"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-error-no-matching-function-for-call-to-usb_device_get_string"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"error: no matching function for call to 'usb_device_get_string'"))))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-error-unknown-type-name-usb_device-did-you-mean-usbdevice"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"error: unknown type name 'usb_device'; did you mean 'UsbDevice'?"))),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-%E5%8F%98%E9%87%8F%E6%B2%A1%E6%9C%89%E4%BD%BF%E7%94%A8%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8E%E6%89%8B%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B%E6%94%BE%E5%BC%83%E5%90%8E%E6%9D%A5%E7%9B%B4%E6%8E%A5%E9%85%8Dmk%E4%BA%86"}),"\u2705 \u53d8\u91cf\u6ca1\u6709\u4f7f\u7528\u7684\u60c5\u51b5\u4e0e\u624b\u52a8\u4fee\u590d\u8fc7\u7a0b\uff08\u653e\u5f03\uff0c\u540e\u6765\u76f4\u63a5\u914dmk\u4e86\uff09")),(0,t.kt)("li",{parentName:"ol"},(0,t.kt)("a",m({parentName:"li"},{href:"#white_check_mark-failed-ninja-frameworksnativeserviceshmdserviceserviceframeworksnativeserviceshmdserviceservicecommonihmdservercpp-needed-by-outtargetproductgeneric_arm64objshared_librarieslibhmdservice_intermediatesframeworksnativeserviceshmdserviceservicecommonihmdservero-missing-and-no-known-rule-to-make-it"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"a"},"FAILED: ninja: 'frameworks/native/services/hmdservice/service/frameworks/native/services/hmdservice/service/common/IHmdServer.cpp', needed by 'out/target/product/generic_arm64/obj/SHARED_LIBRARIES/libhmdservice_intermediates/frameworks/native/services/hmdservice/service/common/IHmdServer.o', missing and no known rule to make it")))))),(0,t.kt)("h2",m({},{id:"\u73af\u5883\u8981\u6c42"}),"\u73af\u5883\u8981\u6c42"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"\u9700\u8981\u6709",(0,t.kt)("inlineCode",{parentName:"li"},"android 10+"),"\u7684\u6574\u7f16\u73af\u5883\u3002"),(0,t.kt)("li",{parentName:"ul"},"\u9700\u8981\u6709",(0,t.kt)("inlineCode",{parentName:"li"},"arpara hmdservice"),"\u7684\u4e00\u5957\u4ee3\u7801\u3002")),(0,t.kt)("h2",m({},{id:"\u5168\u5c40\u53d8\u91cf\u672c\u5730\u793a\u4f8b"}),"\u5168\u5c40\u53d8\u91cf\uff08\u672c\u5730\u793a\u4f8b\uff09"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"ARPARA=$HOME/work@luci/immerex/arpara-hmdservice    # change\nAOSP=~/arpara/android/android-10.0.0_r1             # change\nNATIVE=$AOSP/frameworks/native                      # no need to change\n")),(0,t.kt)("h2",m({},{id:"\u7f16\u8bd1\u603b\u89c8"}),"\u7f16\u8bd1\u603b\u89c8"),(0,t.kt)("ol",null,(0,t.kt)("li",{parentName:"ol"},"\u4e4b\u524d\u7ea0\u7ed3\u4e86\u597d\u4e45",(0,t.kt)("inlineCode",{parentName:"li"},"mk"),"\u8f6c",(0,t.kt)("inlineCode",{parentName:"li"},"bp"),"\u7684\u95ee\u9898\uff0c\u4e5f\u8f6c\u8fc7\uff0c\u4e5f\u80fd\u7528\uff0c\u540e\u6765\u53d1\u73b0\u6ca1\u6709\u5fc5\u8981\uff0c",(0,t.kt)("inlineCode",{parentName:"li"},"Android 10"),"\u4f1a\u81ea\u5df1\u68c0\u6d4b\u6709\u6ca1\u6709",(0,t.kt)("inlineCode",{parentName:"li"},"mk"),"\u6216\u8005",(0,t.kt)("inlineCode",{parentName:"li"},"bp"),"\u6587\u4ef6\uff0c\u7136\u540e\u90fd\u53ef\u4ee5\u7f16\uff0c\u4e24\u4e2a\u6587\u4ef6\u4e0d\u80fd\u540c\u65f6\u6709\uff08\u51c6\u786e\u5730\u8bf4\uff0c\u662f\u91cc\u9762\u7684\u5185\u5bb9\u4e0d\u80fd\u6709\u91cd\u5408\uff0c\u6bd4\u5982\u4e24\u4e2a\u6a21\u5757\u540d\u4e00\u6837\uff09\uff0c\u5426\u5219\u4f1a\u62a5",(0,t.kt)("inlineCode",{parentName:"li"},"XXX has declared"),"\u9519\u3002"),(0,t.kt)("li",{parentName:"ol"},"\u6240\u4ee5\u8fd9\u91cc\u63a8\u8350\uff0c\u4e5f\u4e0d\u7528\u8f6c\u4e86\uff0c\u76f4\u63a5\u57fa\u4e8e\u76ee\u524d\u7684 ",(0,t.kt)("inlineCode",{parentName:"li"},"Android.mk")," \u6539\uff0c\u4e0d\u7136\u540e\u671f\u4e0d\u592a\u597d\u548c\u676d\u5dde\u540c\u5b66\u540c\u6b65\u7ef4\u62a4\uff0c\u4e3b\u8981\u73b0\u5728 ",(0,t.kt)("inlineCode",{parentName:"li"},"Android.mk")," \u8fd8\u6709\u5f88\u5927\u95ee\u9898\uff0c\u53ef\u80fd\u4f1a\u4e00\u76f4\u4fee\u6539\uff0c\u6ca1\u6709\u6210\u578b\uff0c\u90a3\u8f6c\u51fa\u6765\u7684 ",(0,t.kt)("inlineCode",{parentName:"li"},"bp")," \u4e5f\u662f\u6ca1\u6210\u578b\u7684\uff0c\u540e\u671f\u5230\u5e95\u662f\u6539 ",(0,t.kt)("inlineCode",{parentName:"li"},"mk")," \u8fd8\u662f\u6539 ",(0,t.kt)("inlineCode",{parentName:"li"},"bp")," \u8fd9\u5c31\u6d89\u53ca\u5230\u4e00\u4e2a\u540c\u6b65\u95ee\u9898\u3002"),(0,t.kt)("li",{parentName:"ol"},"\u76ee\u524d\u7684\u5171\u8bc6\u662f\u53ea\u8981\u8dd1\u4e00\u4e2aservice\u5373\u53ef\uff0c\u89c2\u5bdf",(0,t.kt)("inlineCode",{parentName:"li"},"service"),"\u76ee\u5f55\u7ed3\u6784\uff0c\uff0c\u4f1a\u53d1\u73b0\u867d\u7136\u6709\u4e24\u4e2a",(0,t.kt)("inlineCode",{parentName:"li"},"Android.mk"),"\u6587\u4ef6\uff0c\u4f46\u662f\u6838\u5fc3\u662f",(0,t.kt)("inlineCode",{parentName:"li"},"service/hmdservice/service/Android.mk"),"\u8fd9\u4e2a\u6587\u4ef6\uff0c\u91cc\u9762\u6709\u4e24\u4e2a\u6a21\u5757\u540d\uff0c\u4e00\u4e2a\u53eb",(0,t.kt)("inlineCode",{parentName:"li"},"libhmdservice"),"\u8fd9\u662f\u670d\u52a1\u7aef\uff0c\u4e00\u4e2a\u53eb",(0,t.kt)("inlineCode",{parentName:"li"},"hmdservice"),"\u8fd9\u662f\u5ba2\u6237\u7aef\uff0c\u5ba2\u6237\u7aef\u4f9d\u8d56\u4e8e\u670d\u52a1\u7aef\uff0c\u6240\u4ee5\u53ef\u4ee5\u5148\u7f16\u670d\u52a1\u7aef\uff0c\u76f4\u63a5",(0,t.kt)("inlineCode",{parentName:"li"},"m libhmdservice"),"\u5373\u53ef\uff0c\u7f16\u597d\u540e\u53ef\u4ee5\u518d\u7f16\u5ba2\u6237\u7aef\uff0c\u76f4\u63a5",(0,t.kt)("inlineCode",{parentName:"li"},"m hmdservice"),"\u63a5\u53e3\u3002"),(0,t.kt)("li",{parentName:"ol"},"\u7f16\u5b8c\u540e\uff0c",(0,t.kt)("inlineCode",{parentName:"li"},"externals"),"\u91cc\u9762\u7684\u6587\u4ef6\u4e0e\u6a21\u5757\u90fd\u4f1a\u6253\u5305\u5230",(0,t.kt)("inlineCode",{parentName:"li"},"hmdservice/service"),"\u76ee\u5f55\u4e0b\uff0c\u5982\u4e0b\uff0c\u53ef\u4ee5\u770b\u5230\u539f\u5148\u7528",(0,t.kt)("inlineCode",{parentName:"li"},".."),"\u7b49\u5f15\u7528\u7684\u6587\u4ef6\u76ee\u5f55\u73b0\u5728\u90fd\u540c\u7ea7\u4e86\u3002\n",(0,t.kt)("img",m({parentName:"li"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643325369686-dbf6353e65673ccf50dc225bb0813c756654bd5e9050afeb884fd2e25ce230c2.png",alt:"picture 155"})),"  ")),(0,t.kt)("h2",m({},{id:"step-1-\u521d\u59cb\u5316\u9879\u76ee"}),"step 1. \u521d\u59cb\u5316\u9879\u76ee"),(0,t.kt)("h3",m({},{id:"fix-1-glm-\u8def\u5f84\u4fee\u6b63"}),"fix 1. ",(0,t.kt)("inlineCode",{parentName:"h3"},"glm")," \u8def\u5f84\u4fee\u6b63"),(0,t.kt)("p",null,"\u666f\u5586\u53d1\u6211\u7684sdk\u91cc\uff0c\u6838\u5fc3\u662f",(0,t.kt)("inlineCode",{parentName:"p"},"service"),"\u4e0e",(0,t.kt)("inlineCode",{parentName:"p"},"externals"),"\u4e24\u4e2a\u6587\u4ef6\u5939\u3002"),(0,t.kt)("p",null,"\u5176\u4e2d ",(0,t.kt)("inlineCode",{parentName:"p"},"externals")," \u6587\u4ef6\u5939\u7684\u76ee\u5f55\u7ed3\u6784\u5982\u4e0b\uff1a"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643324368419-b20be18152a2cbb0d1e959033ebf5fa4cd46036cb96a46447d6c733971ee82ab.png",alt:"picture 152"})),"  "),(0,t.kt)("p",null,"\u6ce8\u610f\uff0c",(0,t.kt)("inlineCode",{parentName:"p"},"glm"),"\u4f5c\u4e3a\u5916\u90e8\u5e93\uff0c\u5b9e\u9645\u8d77\u4f5c\u7528\u7684\u662f\u7eff\u6846\u90e8\u5206\u3002"),(0,t.kt)("p",null,"\u4f46\u662f\u5728 ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk")," \u6587\u4ef6\u5185\u914d\u7f6e\u7684\u8def\u5f84\u5374\u4e3a\uff1a"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643324448613-5fe847f970fa6c394982b88ecb1935008e29a30603ea1d2670f09f26dfc39e07.png",alt:"picture 153"})),"  "),(0,t.kt)("p",null,"\u8fd9\u662f\u4e0d\u5bf9\u7684\uff0c\u8fd9\u6837\u7f16\u8bd1\uff0c\u4f1a\u5bfc\u81f4 ",(0,t.kt)("inlineCode",{parentName:"p"},"glm")," \u4e0b\u7684\u6240\u6709\u6587\u4ef6\u90fd\u627e\u4e0d\u5230\u3002"),(0,t.kt)("p",null,"\u5728\u4e0d\u6539\u53d8\u6587\u4ef6\u7ed3\u6784\u7684\u60c5\u51b5\u4e0b\uff0c\u53ef\u4ee5\u76f4\u63a5\u4fee\u6539 ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk")," \u5c06 ",(0,t.kt)("inlineCode",{parentName:"p"},"glm"),"\u5c42\u7ea7\u52a0\u6df1\u4e00\u7ea7\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643324597991-133228183c45f0a6d5257c2bdaeaf8bcebf5b61543b6e7c0668f2b0aac83e33a.png",alt:"picture 154"})),"  "),(0,t.kt)("h3",m({},{id:"\u9879\u76ee\u62f7\u8d1d"}),"\u9879\u76ee\u62f7\u8d1d"),(0,t.kt)("p",null,"\u63a5\u7740\u5c06 ",(0,t.kt)("inlineCode",{parentName:"p"},"arpara-hmdservice")," \u7684\u4e00\u5957\u4ee3\u7801\u76f4\u63a5\u62f7\u8d1d\u5230 ",(0,t.kt)("inlineCode",{parentName:"p"},"native")," \u4e0b\uff0c\u4fdd\u6301\u76ee\u5f55\u7ed3\u6784\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"cp -r $ARPARA/* $NATIVE\n")),(0,t.kt)("h3",m({},{id:"androidmk-\u914d\u7f6e"}),(0,t.kt)("inlineCode",{parentName:"h3"},"Android.mk")," \u914d\u7f6e"),(0,t.kt)("p",null,"\u8003\u8651\u76ee\u524d\u91c7\u7528 ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk")," \u65b9\u6848\uff0c\u6240\u4ee5 ",(0,t.kt)("inlineCode",{parentName:"p"},"bp")," \u5c31\u4e0d\u7ba1\u4e86\u3002"),(0,t.kt)("p",null,"\u521a\u521a\u5176\u5b9e\u5df2\u7ecf\u8bf4\u4e86\u4e00\u4e2a",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk"),"\u7684\u914d\u7f6e\u6539\u52a8\uff0c\u5173\u4e8e ",(0,t.kt)("inlineCode",{parentName:"p"},"glm")," \u7684\uff0c\u8fd9\u8fd8\u662f\u7b2c\u4e00\u6b65\u3002"),(0,t.kt)("h4",m({},{id:"fix-2-libusbhost"}),"fix 2. ",(0,t.kt)("inlineCode",{parentName:"h4"},"libusbhost")),(0,t.kt)("p",null,"\u7b2c\u4e8c\u6b65\uff0c\u4e00\u4e2a\u5f88\u5927\u7684\u5751\uff0c\u5c31\u662f",(0,t.kt)("inlineCode",{parentName:"p"},"hmdservice"),"\u4e0b\u9762\u6ca1\u6709\u5f15\u5165\u9759\u6001\u5e93",(0,t.kt)("inlineCode",{parentName:"p"},"libusbhost"),"\uff0c\u8fd9\u4f1a\u5bfc\u81f4",(0,t.kt)("inlineCode",{parentName:"p"},"#include <usbhost/usbhost.h>"),"\u5931\u6548\u3002\u6240\u4ee5\u8981\u8865\u4e0a\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643326614099-58e2901ab04c381add6deb8145ad7be1ff18f87c1096c7e7d13d8e6476783544.png",alt:"picture 158"})),"  "),(0,t.kt)("h4",m({},{id:"fix-3-local_cflags"}),"fix 3. ",(0,t.kt)("inlineCode",{parentName:"h4"},"LOCAL_CFLAGS")),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643319315149-0ef8f4f36eae75de9e0544938317df9ae16c51e7e9b818e4885023b7ba13fbec.png",alt:"picture 147"})),"  "),(0,t.kt)("p",null,"\u57fa\u4e8e\u4ee5\u4e0a\u8ba4\u8bc6\uff0c\u6709\u5fc5\u8981\u5bf9\u67d0\u4e9b\u9519\u8bef\u8fdb\u884c\u6291\u5236\uff0c\u53d8\u91cf\u672a\u4f7f\u7528\u7684\u9519\u8bef\u57fa\u672c\u65e0\u5173\u75db\u75d2\u7684\uff0cformat\u4e0d\u5339\u914d\u4e00\u822c\u4e5f\u4e0d\u4f1a\u5f15\u53d1\u7a0b\u5e8f\u9519\u8bef\uff0c\u5c24\u5176\u662f\u5728",(0,t.kt)("inlineCode",{parentName:"p"},"print"),"\u51fd\u6570\u4e2d\u6216\u8005\u5411\u4e0a\u8f6c\u6362\u65f6\u3002"),(0,t.kt)("p",null,"\u56e0\u6b64\u4fee\u6539",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk"),"\u5982\u4e0b\uff0c\u5426\u5219\u7f16\u8bd1\u4e0d\u8fc7\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643327867425-d299e3defc90f9470ab7645780f39e2098f6ecfdb59862c67ae2b4424235d0bb.png",alt:"picture 160"})),"  "),(0,t.kt)("p",null,"\u5177\u4f53\u53ef\u53c2\u8003\uff1a",(0,t.kt)("a",m({parentName:"p"},{href:"#white_check_mark-%E5%8F%98%E9%87%8F%E6%B2%A1%E6%9C%89%E4%BD%BF%E7%94%A8%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8E%E6%89%8B%E5%8A%A8%E4%BF%AE%E5%A4%8D%E8%BF%87%E7%A8%8B%E6%94%BE%E5%BC%83%E5%90%8E%E6%9D%A5%E7%9B%B4%E6%8E%A5%E9%85%8Dmk%E4%BA%86"}),"\u2705 \u53d8\u91cf\u6ca1\u6709\u4f7f\u7528\u7684\u60c5\u51b5\u4e0e\u624b\u52a8\u4fee\u590d\u8fc7\u7a0b\uff08\u653e\u5f03\uff0c\u540e\u6765\u76f4\u63a5\u914dmk\u4e86\uff09")),(0,t.kt)("h4",m({},{id:"androidmk-\u4e8b\u5148\u7f16\u8f91\u7684\u91cd\u8981\u6027"}),"Android.mk \u4e8b\u5148\u7f16\u8f91\u7684\u91cd\u8981\u6027"),(0,t.kt)("p",null,"\u7531\u4e8e\u6bcf\u6b21 ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk")," \u6539\u52a8\u540e\uff0c\u5373\u4f7f\u662f\u7f16\u8bd1\u8be5\u6587\u4ef6\u5939\u4e0b\u7684\u4e00\u4e2a\u5c0f\u6a21\u5757\uff0c\u4e5f\u4f1a\u89e6\u53d1\u5168\u5c40/\u5c40\u90e8\u5237\u65b0\uff0c\u5bfc\u81f4\u7f16\u8bd1\u53d8\u6162\uff0c\u6240\u4ee5\u5c3d\u91cf\u4e00\u6b21\u6027\u5148\u914d\u597d ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk"),"\uff0c\u540e\u7eed\u5c31\u4e0d\u7528\u6539\u914d\u7f6e\uff0c\u76f4\u63a5\u6539\u4ee3\u7801\uff0c\u7f16\u8bd1\u5c31\u4f1a\u5f88\u5feb\u3002"),(0,t.kt)("h2",m({},{id:"step-2-usb-\u63a5\u53e3\u4fee\u590d"}),"step 2. usb \u63a5\u53e3\u4fee\u590d"),(0,t.kt)("p",null,"\u5177\u4f53\u5206\u6790\u53ef\u8df3\u8f6c\uff1a",(0,t.kt)("a",m({parentName:"p"},{href:"#usb-cover-progress"}),"usb cover progress")),(0,t.kt)("h3",m({},{id:"\u4fee\u590d\u9700\u8981\u65b0\u589etimeout\u7684\u4e09\u4e2a\u63a5\u53e3manufacture--product--serial\u5355\u4f4d\u662f\u6beb\u79d2\u76ee\u524d\u6539\u6210\u4e865000"}),"\u4fee\u590d\u9700\u8981\u65b0\u589e",(0,t.kt)("inlineCode",{parentName:"h3"},"timeout"),"\u7684\u4e09\u4e2a\u63a5\u53e3",(0,t.kt)("inlineCode",{parentName:"h3"},"manufacture | product | serial"),"\uff0c\u5355\u4f4d\u662f\u6beb\u79d2\uff0c\u76ee\u524d\u6539\u6210\u4e865000"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'cd $NATIVE/services/hmdservice/service\n\n# add `timeout` param since api changed\nsed -i "s|usb_device_get_manufacturer_name(device)|usb_device_get_manufacturer_name(device, 5000)|" HmdDeviceManager.cpp\nsed -i "s|usb_device_get_product_name(device)|usb_device_get_product_name(device, 5000)|" HmdDeviceManager.cpp\nsed -i "s|usb_device_get_serial(device)|usb_device_get_serial(device, 5000)|" HmdDeviceManager.cpp\n')),(0,t.kt)("h3",m({},{id:"\u5220\u9664name\u6ca1\u6709\u7528\u5230\u63a5\u53e3\u4e5f\u53d8\u4e86\u7684\u4e00\u53e5\u4ee3\u7801"}),"\u5220\u9664",(0,t.kt)("inlineCode",{parentName:"h3"},"*name"),"\u6ca1\u6709\u7528\u5230\uff0c\u63a5\u53e3\u4e5f\u53d8\u4e86\u7684\u4e00\u53e5\u4ee3\u7801"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'cd $NATIVE/services/hmdservice/service\n\n # drop `*name` which is useless and out-of-dated\nsed -i -E "76s|(.*)|//\\1|" HmdDevice.cpp\n')),(0,t.kt)("h2",m({},{id:"step-3-\u4ee3\u7801\u8bed\u6cd5\u4fee\u590d"}),"step 3. \u4ee3\u7801\u8bed\u6cd5\u4fee\u590d"),(0,t.kt)("h3",m({},{id:"-fall-through"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h3"},"fall through")),(0,t.kt)("p",null,"\u8fd9\u662f\u4e00\u4e2acase\u4e0b\u6ca1\u6709break\uff0c\u6211\u6d4f\u89c8\u4e86\u4e00\u4e0b\uff0c99%\u786e\u5b9a\u5e94\u8be5\u662f\u8981\u52a0break\u7684\u3002"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643319911393-50ae8f67ca3dde5e6da651689cb03f8317f77c4ed4ab25708007965c723629db.png",alt:"picture 148"}))),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643327972429-8aae1f5b4e3e1dde1e3095a8ebebaf6c045c282fed81d168e23bffa86a6d25a8.png",alt:"picture 161"})),"  "),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643327995369-fe01fc0318a9a5f60dcbece1527c1131bfe93c6000d53111debe0fa75054ccd6.png",alt:"picture 162"})),"  "),(0,t.kt)("h3",m({},{id:"-\u5220\u9664\u7a7a\u6307\u9488\u95ee\u9898\u8f6c\u4e3a\u8d4b\u503c\u4e3a\u7a7a\u6307\u9488"}),"\u2705 \u5220\u9664\u7a7a\u6307\u9488\u95ee\u9898\uff0c\u8f6c\u4e3a\u8d4b\u503c\u4e3a\u7a7a\u6307\u9488"),(0,t.kt)("p",null,"\u6709\u4e00\u4e9b\u7a7a\u6307\u9488\u5220\u9664\u95ee\u9898\uff0c\u4e2a\u4eba\u91c7\u7528\u4e86\u8d4b\u503c\u4e3a\u7a7a\u6307\u9488\uff0c\u6291\u5236\u4e86\u62a5\u9519\uff0c\u6211\u4e5f\u4e0d\u662fC++\u4e13\u5bb6\uff0c\u5982\u679c\u6211\u7684\u505a\u6cd5\u6709\u8bef\uff0c\u6709\u526f\u4f5c\u7528\uff0c\u8bf7\u6307\u6b63\uff0c\u611f\u89c9\u5e94\u8be5\u662f\u5bf9\u7684\u3002"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'sed -i -E "s|delete (\\w+)|\\1 = nullptr|" HmdService.cpp HmdDevice.cpp HmdDeviceManager.cpp\n')),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643328380750-e31f9a278f13d5e620901fafc55e47784ebd8761a4d1486a23555b2a95bb5a47.png",alt:"picture 163"})),"  "),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643328390889-062fd6f65e1bf48114fdb3b734bb96c159a8d87ad781643f1bf2e64558b3f53b.png",alt:"picture 164"})),"  "),(0,t.kt)("h3",m({},{id:"-\u5176\u4ed6\u4e00\u4e9b\u7c7b\u578b\u8f6c\u6362"}),"\u2705 \u5176\u4ed6\u4e00\u4e9b\u7c7b\u578b\u8f6c\u6362"),(0,t.kt)("p",null,"\u6574\u578b\u7c7b\u578b\u8f6c\u6362\u5f53\u65f6\u5728\u5904\u7406\u65f6\u78b0\u5230\u4e86\u70b9bug\uff0c\u6709\u70b9\u50cf\u73af\uff0c\u6709\u4e09\u4e2a\u51fd\u6570\u91cc\u9762\u7684\u53d8\u91cf\u600e\u4e48\u6362\u90fd\u4e0d\u5bf9\u2026\u2026"),(0,t.kt)("p",null,"\u8003\u8651\u5230\u7c7b\u578b\u8f6c\u6362\u5bf9\u7a0b\u5e8f\u6b63\u786e\u6027\u5f71\u54cd\u4e0d\u5927\uff0c\u800c\u4e14\u90a3\u51e0\u4e2a\u4e3b\u8981\u7528\u4e8e\u6253\u5370\u7684\uff0c\u4e0d\u662f\u505a\u5b9e\u9645\u8ba1\u7b97\uff0c\u6240\u4ee5\u6700\u540e\u6211\u628a\u5b83\u52a0\u5165\u5230\u4e86",(0,t.kt)("inlineCode",{parentName:"p"},"LOCAL_CFLAGS"),"\u91cc\u4e86\uff0c\u5c31\u662f\u90a3\u4e2a",(0,t.kt)("inlineCode",{parentName:"p"},"-Wno-format"),"\u3002"),(0,t.kt)("h2",m({},{id:"\u7f16\u8bd1\u6210\u529f\u6548\u679c"}),"\u7f16\u8bd1\u6210\u529f\u6548\u679c"),(0,t.kt)("h3",m({},{id:"-build-success-of-libhmdservice"}),"\u2728 build success of ",(0,t.kt)("inlineCode",{parentName:"h3"},"libhmdservice")),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643323418539-6548090679139c81754a84cd47460ed9f75d42d34d6185df1b4a5559ce8efbb2.png",alt:"picture 149"})),"  "),(0,t.kt)("h3",m({},{id:"-build-success-of-hmdservice"}),"\u2728\u2728 build success of ",(0,t.kt)("inlineCode",{parentName:"h3"},"hmdservice")),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643323611443-cb33ef62710df8e38b1955d02e861426351f18854017a51f7ff94c8a0298eb1b.png",alt:"picture 150"})),"  "),(0,t.kt)("h2",m({},{id:"\u5f15\u7533\u9605\u8bfb\u5176\u4ed6\u5206\u6790"}),"\u5f15\u7533\u9605\u8bfb/\u5176\u4ed6\u5206\u6790"),(0,t.kt)("h3",m({},{id:"translate-androidmk"}),"translate ",(0,t.kt)("inlineCode",{parentName:"h3"},"Android.mk")),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"ANDROIDMK=`out/soong/host/linux-x86/bin/$ANDROID`\n\nsudo ln -s $ANDROIDMK /usr/local/bin/androidmk\n\ncd $NATIVE/services/hmdservice/service\n\nandroidmk Android.mk > Android.bp\n")),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643307094247-9112acf9b4488e6cbd159319c39ffe544e8fa9d372c5066243b9459cc7f86cbd.png",alt:"picture 126"})),"  "),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643307152936-a88f99c9cdbd14f646b4db367085a8bf64390eb4e4a93ac50717d86563c2763d.png",alt:"picture 127"}))),(0,t.kt)("h3",m({},{id:"-androidbp-path-is-outside-directory"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h3"},"Android.bp: Path is outside directory")),(0,t.kt)("p",null,"problem:"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643307338978-a81179a15f28f671b97b7bb5f04ed4d8c527b279d3ec0042e18a3cc0b0465ceb.png",alt:"picture 128"})),"  "),(0,t.kt)("p",null,"analysis:"),(0,t.kt)("p",null,"There are not too many refs, so we can simply move them to under ",(0,t.kt)("inlineCode",{parentName:"p"},"service/hmdservice/service"),"."),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643307400267-e04276fbe02a1bfe6f470716a4bd7800ac41625f0e31db7727ba9fcd2b96085c.png",alt:"picture 129"})),"  "),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'cd services/hmdservice/service\n\nmv ../../../externals/glm ./\nsed -i "s|../../../externals/glm|glm|g" Android.bp\nmv ../common .\nsed -i "s|../common|common|g" Android.bp\nmv ../cv .\nsed -i "s|../cv|cv|g" Android.bp\n\nm hmdservice\n')),(0,t.kt)("p",null,"result:"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643308322613-edc2554631fc57cd30e3d2c86d20d0086130ddde315a935c733e0530d487fe23.png",alt:"picture 130"})),"  "),(0,t.kt)("h3",m({},{id:"-error-frameworksnativeserviceshmdserviceservice-moduletargetshared_librarieslibhmdservice-already-defined-by-frameworksnativeserviceshmdserviceservice"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h3"},"error: frameworks/native/services/hmdservice/service: MODULE.TARGET.SHARED_LIBRARIES.libhmdservice already defined by frameworks/native/services/hmdservice/service.")),(0,t.kt)("p",null,"analysis:"),(0,t.kt)("p",null,"In fact, the error may owes to the duplicated definition by both ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk")," and ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.bp"),"."),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("p",null,"Delete or bak the ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk"),"."),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"# service/hmdservice/service/Android.mk [core]\n# maybe no need, but for explicitly using `Android.bp`\nmv Android.mk Android.mk.bak\n\n# service/hmdservice/Android.mk [redundant]\nmv ../Android.mk ../Android.mk.bak\n")),(0,t.kt)("hr",null),(0,t.kt)("p",null,"The former resolution may be right, but after then I changed back to ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.mk"),", hence the errors arise again."),(0,t.kt)("p",null,"reason:"),(0,t.kt)("p",null,"I'm silly since I used ",(0,t.kt)("inlineCode",{parentName:"p"},"cp")," again to have generated an ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.bp.bak")," so that there are `Androi"),(0,t.kt)("h3",m({},{id:"-fatal-error-usbhostusbhosth-file-not-found"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h3"},"fatal error: 'usbhost/usbhost.h' file not found")),(0,t.kt)("p",null,"problem:"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643309016631-58f9e2f7b0d674c10ed3d222c77c02e24ae12cdab12cfee7866ea0d97fd8721b.png",alt:"picture 131"})),"  "),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("p",null,"just comment/delete that line."),(0,t.kt)("p",null,"result:"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643309450092-da8e3e51f68cb408eef7097c16369628521839b0e5094e92cf63bbad6b45b34d.png",alt:"picture 132"})),"  "),(0,t.kt)("p",null,"wrong!"),(0,t.kt)("hr",null),(0,t.kt)("p",null,"analysis:"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643310177554-57f83166b9b997424737e2765d2e55c9ee7772dbc86a1cece965f0150ce5ce15.png",alt:"picture 133"})),"  "),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("p",null,"don't comment it."),(0,t.kt)("p",null,"and then it seems ok now."),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643310248334-49665e1ff7c04cdf40b6e9a8d3b6b6c242b6cb2779e55f8365305153c25ecd5a.png",alt:"picture 134"})),"  "),(0,t.kt)("p",null,"wrong!"),(0,t.kt)("hr",null),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("p",null,"compile the ",(0,t.kt)("inlineCode",{parentName:"p"},"usbhost")," first."),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643311568636-edecb257058c690a14f0cca66007371acbe2bd218657e9ab407dbb1851186779.png",alt:"picture 136"})),"  "),(0,t.kt)("p",null,"wrong!"),(0,t.kt)("hr",null),(0,t.kt)("p",null,"analysis:"),(0,t.kt)("p",null,"The ",(0,t.kt)("inlineCode",{parentName:"p"},"usbhost")," is not alone only from under ",(0,t.kt)("inlineCode",{parentName:"p"},"sys"),"."),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643311965426-5738d84bc2fdf6deab2e95a50dd0008968d8fe383c5e310dd32a4ea6b1f67071.png",alt:"picture 137"})),"  "),(0,t.kt)("p",null,"So why only ",(0,t.kt)("inlineCode",{parentName:"p"},"usbhost")," raises error?"),(0,t.kt)("p",null,"One reason mey be that it isn't included in the ",(0,t.kt)("inlineCode",{parentName:"p"},"Android.bp")," while others like ",(0,t.kt)("inlineCode",{parentName:"p"},"String8.h")," of lib ",(0,t.kt)("inlineCode",{parentName:"p"},"libutils")," is."),(0,t.kt)("p",null,"Awful! That's it!"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643312190595-c6352cb9bbb21c1f76c47429967746ff28ffd19734cc2d910cc09682ebeda4cd.png",alt:"picture 138"})),"  "),(0,t.kt)("p",null,"And okay!"),(0,t.kt)("h3",m({},{id:"usb-cover-progress"}),"usb cover progress"),(0,t.kt)("h4",m({},{id:"-error-no-matching-function-for-call-to-usb_device_get_manufacturer_name"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h4"},"error: no matching function for call to 'usb_device_get_manufacturer_name'")),(0,t.kt)("p",null,"analysis:"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643312994745-efcdee1fb2404efb3e4856530fa8af6fa13753f898b67565a92e112d60ea4d2c.png",alt:"picture 139"})),"  "),(0,t.kt)("p",null,"Obviously! It's because api change!"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643313212330-a3b0b516376b57536e5959d682d9d6b13cade24be0f589eb5112f4482085ccf0.png",alt:"picture 140"})),"  "),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'sed -i "s|usb_device_get_manufacturer_name(device)|usb_device_get_manufacturer_name(device, 5000)|" HmdDeviceManager.cpp\nsed -i "s|usb_device_get_product_name(device)|usb_device_get_product_name(device, 5000)|" HmdDeviceManager.cpp\nsed -i "s|usb_device_get_serial(device)|usb_device_get_serial(device, 5000)|" HmdDeviceManager.cpp\n')),(0,t.kt)("p",null,"extended reading:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"timeout")," unit is ",(0,t.kt)("inlineCode",{parentName:"li"},"ms"),": ",(0,t.kt)("a",m({parentName:"li"},{href:"https://www.ftdichip.com/Support/Knowledgebase/index.html?usbtimeout.htm"}),"FTDI Knowledgebase"))),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643313605044-e7a4aaeff480b32897c9580e9b8b99ea4999c2d8f6c0889b3a96e33ef300e9d3.png",alt:"picture 141"})),"  "),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"usbhost definition: ",(0,t.kt)("a",m({parentName:"li"},{href:"http://docs.ros.org/en/kinetic/api/librealsense2/html/usbhost_8h.html#a4a0722741758e228eea537a8d6f78a23"}),"librealsense2: usbhost.h File Reference"))),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643313640291-f473da436be2b06b1a35c261445783d17b2b9cd4b13b78217bbb809801f0f682.png",alt:"picture 142"})),"  "),(0,t.kt)("h4",m({},{id:"-error-no-matching-function-for-call-to-usb_device_get_string"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h4"},"error: no matching function for call to 'usb_device_get_string'")),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643314676811-c9751f6c959f85f7984802217366367ea4412a25888e6a5038eef8c931838743.png",alt:"picture 143"})),"  "),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'# drop *name which is useless and out-of-dated\nsed -i -E "76s|(.*)|//\\1|" HmdDevice.cpp\n')),(0,t.kt)("p",null,"drop the line since useless and out-of-date."),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643315231955-9f573c133950bd0c1198bd98e4a1173c88671fd7195046ee76a5a1a38e8f7407.png",alt:"picture 144"})),"  "),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643315348108-f44479f0d9247cb8849c39c1be83fe2727c1628594207756bc022d621e5ef1e8.png",alt:"picture 145"})),"  "),(0,t.kt)("h3",m({},{id:"-error-unknown-type-name-usb_device-did-you-mean-usbdevice"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h3"},"error: unknown type name 'usb_device'; did you mean 'UsbDevice'?")),(0,t.kt)("p",null,"reason:"),(0,t.kt)("p",null,"I commented the ",(0,t.kt)("inlineCode",{parentName:"p"},"usbhost.h")),(0,t.kt)("p",null,"resolution:"),(0,t.kt)("p",null,"Add it back."),(0,t.kt)("h3",m({},{id:"-\u53d8\u91cf\u6ca1\u6709\u4f7f\u7528\u7684\u60c5\u51b5\u4e0e\u624b\u52a8\u4fee\u590d\u8fc7\u7a0b\u653e\u5f03\u540e\u6765\u76f4\u63a5\u914dmk\u4e86"}),"\u2705 \u53d8\u91cf\u6ca1\u6709\u4f7f\u7528\u7684\u60c5\u51b5\u4e0e\u624b\u52a8\u4fee\u590d\u8fc7\u7a0b\uff08\u653e\u5f03\uff0c\u540e\u6765\u76f4\u63a5\u914dmk\u4e86\uff09"),(0,t.kt)("p",null,"problem:"),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643310792765-8d0f4c98a3ea3dc027642153dbb7d35e1f0cc605e2f89b92276ba688a2b1c10b.png",alt:"picture 135"})),"  "),(0,t.kt)("pre",null,(0,t.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'# comment\nsed -i -E "494s|(.*)|//\\1|" HmdService.cpp\nsed -i -E "258s|(.*)|//\\1|" HmdService.h\nsed -i -E "262s|(.*)|//\\1|" HmdService.h\n\n# uncomment\nsed -i -E "494s|^//||" HmdService.cpp\nsed -i -E "258s|^//||" HmdService.h\nsed -i -E "262s|^//||" HmdService.h\n')),(0,t.kt)("h3",m({},{id:"-failed-ninja-frameworksnativeserviceshmdserviceserviceframeworksnativeserviceshmdserviceservicecommonihmdservercpp-needed-by-outtargetproductgeneric_arm64objshared_librarieslibhmdservice_intermediatesframeworksnativeserviceshmdserviceservicecommonihmdservero-missing-and-no-known-rule-to-make-it"}),"\u2705 ",(0,t.kt)("inlineCode",{parentName:"h3"},"FAILED: ninja: 'frameworks/native/services/hmdservice/service/frameworks/native/services/hmdservice/service/common/IHmdServer.cpp', needed by 'out/target/product/generic_arm64/obj/SHARED_LIBRARIES/libhmdservice_intermediates/frameworks/native/services/hmdservice/service/common/IHmdServer.o', missing and no known rule to make it")),(0,t.kt)("p",null,(0,t.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/hmdservice-1643317742418-27354174370a423f3b5f3f487370d9051454bf4003bbae27de8eaefda8520e7e.png",alt:"picture 146"}))))}b.isMDXComponent=!0}}]);