"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[7729],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>u});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var p=n.createContext({}),s=function(e){var t=n.useContext(p),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=s(e.components);return n.createElement(p.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,p=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=s(a),u=r,k=c["".concat(p,".").concat(u)]||c[u]||m[u]||o;return a?n.createElement(k,i(i({ref:t},d),{},{components:a})):n.createElement(k,i({ref:t},d))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=c;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=a[s];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},82463:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>f,contentTitle:()=>u,default:()=>b,frontMatter:()=>c,metadata:()=>k,toc:()=>h});var n=a(3905),r=Object.defineProperty,o=Object.defineProperties,i=Object.getOwnPropertyDescriptors,l=Object.getOwnPropertySymbols,p=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,d=(e,t,a)=>t in e?r(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,m=(e,t)=>{for(var a in t||(t={}))p.call(t,a)&&d(e,a,t[a]);if(l)for(var a of l(t))s.call(t,a)&&d(e,a,t[a]);return e};const c={},u="frameworks howto",k={unversionedId:"AndroidFramework/frameworks-howto",id:"AndroidFramework/frameworks-howto",title:"frameworks howto",description:"instruction",source:"@site/docs/AndroidFramework/frameworks-howto.md",sourceDirName:"AndroidFramework",slug:"/AndroidFramework/frameworks-howto",permalink:"/keeps-learning/docs/AndroidFramework/frameworks-howto",draft:!1,editUrl:"https://github.com/markshawn2020/keeps-learning/edit/master/docs/AndroidFramework/frameworks-howto.md",tags:[],version:"current",lastUpdatedAt:1658911274,formattedLastUpdatedAt:"2022\u5e747\u670827\u65e5",frontMatter:{},sidebar:"docs",previous:{title:"\u5357\u5ddd\u6838\u5fc3\u7814\u53d1\u7b14\u8bb0 | VR\u7cfb\u7edf\u539f\u7406\u4e0e\u8bbe\u8ba1\u5b9e\u73b0",permalink:"/keeps-learning/docs/AndroidFramework/arpara/mark_vr-principle-and-implementation"},next:{title:"Manual/bugfix of compiling arpara hmdservice on AOSP 10",permalink:"/keeps-learning/docs/AndroidFramework/hmdservice/TaskB1-hmdservice-compile/how-to-compile-arpara-hmdservice-on-AOSP10"}},f={},h=[{value:"instruction",id:"instruction",level:2},{value:"AOSP",id:"aosp",level:2},{value:"IDE review java frameworks",id:"ide-review-java-frameworks",level:2},{value:"compile <code>idegen</code>",id:"compile-idegen",level:3},{value:"config <code>ulimit</code>",id:"config-ulimit",level:3},{value:"android-studio <code>.vmoption</code> config",id:"android-studio-vmoption-config",level:3},{value:"android-studio <code>inotify limit</code> config",id:"android-studio-inotify-limit-config",level:3},{value:"use custom framework/jdk",id:"use-custom-frameworkjdk",level:3},{value:"use <code>facets/gradle</code>",id:"use-facetsgradle",level:3},{value:"debug java frameworks",id:"debug-java-frameworks",level:3},{value:"IDE review native frameworks",id:"ide-review-native-frameworks",level:2},{value:"read native Frameworks",id:"read-native-frameworks",level:3},{value:"\u5bfc\u5165 <code>out/**/CMakeLists.txt</code> \u5de5\u7a0b\u540e\u7684\u7f16\u8bd1",id:"\u5bfc\u5165-outcmakeliststxt-\u5de5\u7a0b\u540e\u7684\u7f16\u8bd1",level:3},{value:"debug native frameworks",id:"debug-native-frameworks",level:2},{value:"\u751f\u6210debug\u7248\u672c\u7684framework\u6587\u4ef6",id:"\u751f\u6210debug\u7248\u672c\u7684framework\u6587\u4ef6",level:3},{value:"debug <code>.so</code> file",id:"debug-so-file",level:3},{value:"debug native",id:"debug-native",level:3},{value:"LLDB relative",id:"lldb-relative",level:3},{value:"FIXED: <code>ld.lld: error: undefined symbol: graphic_policy(int)</code>",id:"fixed-ldlld-error-undefined-symbol-graphic_policyint",level:3},{value:"\u5c5e\u6027\u8be6\u89e3",id:"\u5c5e\u6027\u8be6\u89e3",level:2},{value:"\u5b98\u65b9\u53c2\u8003",id:"\u5b98\u65b9\u53c2\u8003",level:3},{value:"\u7cfb\u7edf\u5c5e\u6027\u89e3\u51b3\u65b9\u6848\u5bf9\u7167\u8868",id:"\u7cfb\u7edf\u5c5e\u6027\u89e3\u51b3\u65b9\u6848\u5bf9\u7167\u8868",level:3},{value:"\u5c5e\u6027\u547d\u4ee4",id:"\u5c5e\u6027\u547d\u4ee4",level:3},{value:"\u5c5e\u6027\u5217\u8868",id:"\u5c5e\u6027\u5217\u8868",level:3},{value:"\u5c5e\u6027\u5728adb\u4e2d\u7684\u8bbf\u95ee",id:"\u5c5e\u6027\u5728adb\u4e2d\u7684\u8bbf\u95ee",level:3},{value:"\u5c5e\u6027\u5728\u4ee3\u7801\u4e2d\u7684\u8bbf\u95ee",id:"\u5c5e\u6027\u5728\u4ee3\u7801\u4e2d\u7684\u8bbf\u95ee",level:3},{value:"<code>SystemProperties</code> \u548c <code>SettingsProvider</code>",id:"systemproperties-\u548c-settingsprovider",level:3}],g={toc:h};function b(e){var t,a=e,{components:r}=a,d=((e,t)=>{var a={};for(var n in e)p.call(e,n)&&t.indexOf(n)<0&&(a[n]=e[n]);if(null!=e&&l)for(var n of l(e))t.indexOf(n)<0&&s.call(e,n)&&(a[n]=e[n]);return a})(a,["components"]);return(0,n.kt)("wrapper",(t=m(m({},g),d),o(t,i({components:r,mdxType:"MDXLayout"}))),(0,n.kt)("h1",m({},{id:"frameworks-howto"}),"frameworks howto"),(0,n.kt)("h2",m({},{id:"instruction"}),"instruction"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://www.zhihu.com/question/46486807/answer/1724325999"}),"(19 \u5c01\u79c1\u4fe1 / 66 \u6761\u6d88\u606f) Android Framework \u5982\u4f55\u5b66\u4e60\uff0c\u5982\u4f55\u4ece\u5e94\u7528\u6df1\u5165\u5230Framework\uff1f - \u77e5\u4e4e"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u2728  \u6559\u4f1a\u4f60",(0,n.kt)("inlineCode",{parentName:"p"},"hmm | godir | jgrep | cgrep"),"\u7684\u4f7f\u7528",(0,n.kt)("a",m({parentName:"p"},{href:"https://www.youtube.com/watch?v=NsqFOSzoYE8&t=120s"}),"Tutorial: Diving into Android Source Code - YouTube"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u2728 \u2728 \u6559\u4f60\u7528gdb\u8c03\u8bd5Native C++\u4ee3\u7801 ",(0,n.kt)("a",m({parentName:"p"},{href:"https://www.cntofu.com/book/46/android_note/gdbzai_xian_diao_shi_android_framework_native_c__c.md"}),"GDB\u5728\u7dda\u8abf\u8a66Android Framework Native C/C++\u4ee3\u78bc-\u8f6f\u4ef6\u5f00\u53d1\u5e73\u53f0\u53ca\u8bed\u8a00\u7b14\u8bb0\u5927\u5168(\u8d85\u8be6\u7ec6)")))),(0,n.kt)("h2",m({},{id:"aosp"}),"AOSP"),(0,n.kt)("h2",m({},{id:"ide-review-java-frameworks"}),"IDE review java frameworks"),(0,n.kt)("h3",m({},{id:"compile-idegen"}),"compile ",(0,n.kt)("inlineCode",{parentName:"h3"},"idegen")),(0,n.kt)("p",null,"use ",(0,n.kt)("inlineCode",{parentName:"p"},"bash")," (not ",(0,n.kt)("inlineCode",{parentName:"p"},"zsh"),", otherwise the script won't pass, see:  ",(0,n.kt)("a",m({parentName:"p"},{href:"https://www.jianshu.com/p/2a4731385773"}),"mmm\u7f16\u8bd1\u6a21\u5757\u62a5\u9519Couldn't locate the directory - \u7b80\u4e66"),")"),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"bash\nsource build/envsetup.sh && lunch rk3399_Android10-userdebug\n\nmmm development/tools/idegen\n")),(0,n.kt)("h3",m({},{id:"config-ulimit"}),"config ",(0,n.kt)("inlineCode",{parentName:"h3"},"ulimit")),(0,n.kt)("p",null,"otherwise, the android studio would complain the logs (each module would) and it would be rather slow to index (more than half of hour or more)."),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-sh"}),'echo "ulimit -S -n 2048" >> ~/.bashrc\n\nbash\nsource ~/.bashrc\n')),(0,n.kt)("p",null,"ref:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",m({parentName:"li"},{href:"https://zhuanlan.zhihu.com/p/295363172"}),"Android Studio \u8c03\u8bd5 Android Framework \u5c42\u4ee3\u7801 - \u77e5\u4e4e"))),(0,n.kt)("h3",m({},{id:"android-studio-vmoption-config"}),"android-studio ",(0,n.kt)("inlineCode",{parentName:"h3"},".vmoption")," config"),(0,n.kt)("p",null,"ensure the place."),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/source-code-insiight-1644589276145-6355a0fabcb222d1f85a965635bd965a11382b02e77f48b69062a30c4a3deeb9.png",alt:"picture 3"})),"  "),(0,n.kt)("p",null,"ensure not some wrong configs (like spell errors)"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/source-code-insiight-1644589315281-ce2d0704b9928321b451ec4098cb98d4f3f5dc0ea3f6a9678460960a6f48982b.png",alt:"picture 4"})),"  "),(0,n.kt)("p",null,"see: "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",m({parentName:"li"},{href:"https://intellij-support.jetbrains.com/hc/en-us/community/posts/360004340840-Unrecognized-VM-option-UseCompressedOops-"}),"Unrecognized VM option 'UseCompressedOops ' \u2013 IDEs Support (IntelliJ Platform) | JetBrains"))),(0,n.kt)("h3",m({},{id:"android-studio-inotify-limit-config"}),"android-studio ",(0,n.kt)("inlineCode",{parentName:"h3"},"inotify limit")," config"),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf && sudo sysctl -p\n")),(0,n.kt)("p",null,"ref:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",m({parentName:"li"},{href:"https://stackoverflow.com/questions/33959353/android-studio-shows-the-warning-inotify-limit-is-too-low/56756211"}),"performance - Android Studio shows the warning inotify limit is too low - Stack Overflow"))),(0,n.kt)("h3",m({},{id:"use-custom-frameworkjdk"}),"use custom framework/jdk"),(0,n.kt)("p",null,"see:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u2728 \u2728 \u2728  \u4e00\u7bc7\u975e\u5e38\u8be6\u7ec6\u7684\u6587\u7ae0\uff1a",(0,n.kt)("a",m({parentName:"p"},{href:"http://riveryoung.cn/2020/12/09/Android-Framework-Debug/"}),"Android Framework \u8c03\u8bd5 | River Young"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u6709\u4e9b\u5730\u65b9\u4e0d\u662f\u5f88\u6e05\u695a\uff1a",(0,n.kt)("a",m({parentName:"p"},{href:"https://zhuanlan.zhihu.com/p/295363172"}),"Android Studio \u8c03\u8bd5 Android Framework \u5c42\u4ee3\u7801 - \u77e5\u4e4e")))),(0,n.kt)("h3",m({},{id:"use-facetsgradle"}),"use ",(0,n.kt)("inlineCode",{parentName:"h3"},"facets/gradle")),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/source-code-insiight-1644583979433-a190875f6a0fee43a3088913057cf07379166f6d9e9925f609d721590bb8eee0.png",alt:"picture 1"})),"  "),(0,n.kt)("p",null,"\u770b\u8d77\u6765\u5f88\u6709\u6548\uff1a"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/source-code-insiight-1644584892009-cf9b9116092580e9be6b7407c15d4e67adb461017270db9a843db3ad17d3d7d8.png",alt:"picture 2"})),"  "),(0,n.kt)("p",null,"see: "),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"\u914d\u7f6e\u667a\u80fd\u63d0\u793a\uff1a",(0,n.kt)("a",m({parentName:"li"},{href:"https://stackoverflow.com/questions/33231460/frameworks-detected-in-android-studio"}),"Frameworks detected in android studio - Stack Overflow"))),(0,n.kt)("h3",m({},{id:"debug-java-frameworks"}),"debug java frameworks"),(0,n.kt)("p",null,"ref:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u2728 \u2728 \u8fd9\u4e2a\u4e0d\u9519\uff0c\u91cc\u9762\u8bb2\u4e86\u5f88\u591a\u79cd\u529e\u6cd5\uff0c\u6bd4\u5982\u65e5\u5fd7\u65ad\u70b9\uff01\u503c\u5f97\u5b66\u4e60\uff01 ",(0,n.kt)("a",m({parentName:"p"},{href:"https://weishu.me/2015/12/21/android-studio-debug-tips-you-may-not-know/"}),"Android Studio\u4f60\u4e0d\u77e5\u9053\u7684\u8c03\u8bd5\u6280\u5de7 | Weishu's Notes"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"http://riveryoung.cn/2020/12/09/Android-Framework-Debug/"}),"Android Framework \u8c03\u8bd5 | River Young")))),(0,n.kt)("h2",m({},{id:"ide-review-native-frameworks"}),"IDE review native frameworks"),(0,n.kt)("h3",m({},{id:"read-native-frameworks"}),"read native Frameworks"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"\u6253\u5f00\u4ee5\u4e0b\u5f00\u5173\uff0c\u7f16\u8bd1\u65f6\u5c31\u4f1a\u81ea\u52a8\u751f\u6210 ",(0,n.kt)("inlineCode",{parentName:"li"},"**/CMakeLists.txt"))),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"SOONG_GEN_CMAKEFILES=1 SOONG_GEN_CMAKEFILES_DEBUG=1\n")),(0,n.kt)("p",null,"\u76ee\u5f55\u5728 ",(0,n.kt)("inlineCode",{parentName:"p"},"out/development/ide/clion/frameworks/native/**/CMakeLists.txt")),(0,n.kt)("ol",m({},{start:2}),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"\u5728",(0,n.kt)("inlineCode",{parentName:"p"},"clion"),"\u4e2d\u6253\u5f00 ",(0,n.kt)("inlineCode",{parentName:"p"},"CROOT/frameworks/native"),"\uff0c\u6b64\u65f6\u662f\u6ca1\u6709\u667a\u80fd\u63d0\u793a\u7684")),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"\u5728",(0,n.kt)("inlineCode",{parentName:"p"},"clion"),"\u4e2d\u5f15\u5165\u6211\u4eec\u7684\u6839\u76ee\u5f55",(0,n.kt)("inlineCode",{parentName:"p"},"cmake"),"\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f",(0,n.kt)("inlineCode",{parentName:"p"},"out/development/ide/clion/frameworks/native/CMakeLists.txt"))),(0,n.kt)("li",{parentName:"ol"},(0,n.kt)("p",{parentName:"li"},"\u6807\u8bb0\u6211\u4eec",(0,n.kt)("inlineCode",{parentName:"p"},"Project"),"\u89c6\u56fe\u4e0b\u7684\u6839\u76ee\u5f55\u4e3a",(0,n.kt)("inlineCode",{parentName:"p"},"Root for Headers and Sources")))),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/source-code-insiight-1644610581905-27d806130ee09121eab597bcfb7861ea3259f5135c75c44005a032a53f8a8f9d.png",alt:"picture 7"})),"  "),(0,n.kt)("ol",m({},{start:5}),(0,n.kt)("li",{parentName:"ol"},"\u91cd\u542fIDE\uff0c\u7b49\u5f85\u7d22\u5f15\u66f4\u65b0\u5b8c\u6210\uff0c\u7136\u540e\u81ea\u52a8\u8df3\u8f6c\u5c31\u914d\u597d\u4e86\uff01\u829c\u6e56\u8d77\u98de\uff01")),(0,n.kt)("p",null,"!!!warning\n\u6ce8\u610f\uff0c\u8c8c\u4f3c\u57fa\u4e8e",(0,n.kt)("inlineCode",{parentName:"p"},"SOONG_GEN_CMAKEFILES"),"\u751f\u6210 ",(0,n.kt)("inlineCode",{parentName:"p"},"CMakeLists.txt")," \u7684\u65b9\u5f0f\uff0c\u5f00\u9500\u8fd8\u662f\u5f88\u5927\u7684\uff0c\u6240\u4ee5\u7f16\u8bd1\u8f83\u6162\uff08\u611f\u89c9\u6162\u4e86\u4e24\u4e09\u500d\uff09\uff0c\u6240\u4ee5\u5982\u679capi\u6ca1\u6709\u4ec0\u4e48\u5927\u53d8\u52a8\uff0c\u7f16\u4e86\u4e00\u6b21\u540e\u4e0b\u6b21\u5c31\u4e0d\u8981\u542f\u7528\u4e86\u3002\u6240\u4ee5\u6bd4\u8f83\u5408\u9002\u7684\u662f\u4e0d\u8981\u5bfc\u51fa\u2026\u2026"),(0,n.kt)("hr",null),(0,n.kt)("p",null,"TODO: \u4f46\u662f\u6211\u540e\u6765\u53d1\u73b0\uff0c\u8fd8\u4e0d\u591f\u3002 \u7f16\u8bd1\u81ea\u52a8\u751f\u6210\u7684 ",(0,n.kt)("inlineCode",{parentName:"p"},"CMakeLists.txt")," \u91cc\u5305\u542b\u7684\u5e93\u8865\u5168\uff0c\u9700\u8981\u81ea\u5df1\u624b\u52a8\u6dfb\u52a0\u76ee\u6807\u5e93\u3002\u7136\u540e\u8fd9\u4e9b\u5e93\u7684cpp\u6587\u4ef6\u5c31\u4f1a\u90fd\u7f57\u5217\u5728\u9879\u76ee\u6839\u76ee\u5f55\u4e0b\uff0c\u81f3\u4e8e\u4e3a\u5565\u4e0d\u662f\u6811\u72b6\u7ed3\u6784\uff0c\u662f\u56e0\u4e3a\u8fd9\u4e9b\u90fd\u662f\u5f15\u7528\uff0c\u5e76\u4e14\u6765\u81ea\u4e0d\u540c\u7684\u76ee\u5f55\u7ed3\u6784\u3002"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1645591398752-6e0ca8269ca425919dbb14fa129d684a4e99effafccf0f06b586220d59f673ea.png",alt:"picture 28"})),"  "),(0,n.kt)("p",null,"ref:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",m({parentName:"li"},{href:"http://blog.hanschen.site/2019/10/11/aosp-native-ide/"}),"\u5982\u4f55\u987a\u6ed1\u5730\u67e5\u770b Android Native \u4ee3\u7801 | HansChen \u7684\u535a\u5ba2"))),(0,n.kt)("h3",m({},{id:"\u5bfc\u5165-outcmakeliststxt-\u5de5\u7a0b\u540e\u7684\u7f16\u8bd1"}),"\u5bfc\u5165 ",(0,n.kt)("inlineCode",{parentName:"h3"},"out/**/CMakeLists.txt")," \u5de5\u7a0b\u540e\u7684\u7f16\u8bd1"),(0,n.kt)("p",null,"\u5728\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\uff0c\u7531\u4e8e\u548c\u5b89\u5353\u9ed8\u8ba4\u7f16\u8bd1\u73af\u5883\u4e0d\u4e00\u6837\uff0c\u53ef\u80fd\u4f1a\u5b58\u5728\u5404\u79cd\u5404\u6837\u7684\u95ee\u9898\uff0c\u5c24\u5176\u662f\u8bed\u6cd5\u95ee\u9898\u3002"),(0,n.kt)("p",null,"\u6d89\u53ca\u5230\u8bed\u6cd5\u95ee\u9898\uff0c\u7b80\u5355\u68c0\u67e5\u4f1a\u53d1\u73b0\uff0c\u4e00\u822c\u90fd\u4e0d\u662f\u4ec0\u4e48\u5927\u95ee\u9898\uff0c\u56e0\u6b64\u5c31\u8981\u628a\u4ed6\u4eec\u5c4f\u853d\u3002"),(0,n.kt)("p",null,"\u529e\u6cd5\u5c31\u662f\u4fee\u6539\u5bf9\u5e94\u7684 ",(0,n.kt)("inlineCode",{parentName:"p"},"CMakeLists.txt")," \u6587\u4ef6\uff0c\u6574\u4e2a\u6587\u4ef6\u5206\u6210\u81ea\u5df1\u5305\u5e93\u4e0e\u4f9d\u8d56\u5305\u5e93\uff0c\u4e00\u822c\u662f\u5728\u4f9d\u8d56\u5305\u5e93\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u5728\u6700\u540e\u9762\u7684 ",(0,n.kt)("inlineCode",{parentName:"p"},"CXX-FALGS")," \u540e\u9762\u4e00\u6b21\u6b21\u7f16\u8bd1\u8865\u4e0a\u6240\u9700\u8981\u7684\u5c4f\u853d\u6761\u4ef6\u5373\u53ef\uff0c\u4f8b\u5982\u6211\u5728\u7f16\u8bd1 ",(0,n.kt)("inlineCode",{parentName:"p"},"libsurfaceflinger")," \u4e2d\uff0c\u8981\u8865\u5168\u7684\u6761\u76ee\u5982\u4e0b\uff1a"),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-cpp"}),'set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-implicit-int-float-conversion")\nset(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-deprecated-copy")\nset(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -Wno-reorder-init-list")\n')),(0,n.kt)("h2",m({},{id:"debug-native-frameworks"}),"debug native frameworks"),(0,n.kt)("p",null,"ref:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"\u2728 \u2728 \u2728 \u3010\u7edd\u5bf9\u63a8\u8350\u3011\u4e00\u5b9a\u8981\u638c\u63e1 ",(0,n.kt)("a",m({parentName:"p"},{href:"https://weishu.me/2017/01/14/how-to-debug-android-native-framework-source/"}),"\u5982\u4f55\u8c03\u8bd5Android Native Framework | Weishu's Notes"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"(CSDN\u7248\uff0c\u53ef\u80fd\u662f\u540c\u4e00\u4e2a\u4eba) ",(0,n.kt)("a",m({parentName:"p"},{href:"https://blog.csdn.net/sinat_29384657/article/details/76685742?ops_request_misc=&request_id=&biz_id=102&utm_term=android%20studio%20native%20%E8%B0%83%E8%AF%95&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-3-76685742.pc_search_result_control_group&spm=1018.2226.3001.4187"}),"(1\u6761\u6d88\u606f) \u5982\u4f55\u8c03\u8bd5Android Native Framework_android\u7684\u535a\u5ba2-CSDN\u535a\u5ba2_android native\u8c03\u8bd5")))),(0,n.kt)("h3",m({},{id:"\u751f\u6210debug\u7248\u672c\u7684framework\u6587\u4ef6"}),"\u751f\u6210debug\u7248\u672c\u7684framework\u6587\u4ef6"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",m({parentName:"li"},{href:"https://stackoverflow.com/questions/21447675/how-to-make-debug-build-of-specific-module-under-aosp-tree"}),"android ndk - How to make debug build of specific module under AOSP tree? - Stack Overflow"))),(0,n.kt)("h3",m({},{id:"debug-so-file"}),"debug ",(0,n.kt)("inlineCode",{parentName:"h3"},".so")," file"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://zhuanlan.zhihu.com/p/58468014"}),"Android \u52a8\u6001\u8c03\u8bd5so\u6587\u4ef6 - \u77e5\u4e4e"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://www.geek-share.com/detail/2798359447.html"}),"\u7b2c\u4e5d\u7ae0 Android \u539f\u751f\u7a0b\u5e8f\u52a8\u6001\u8c03\u8bd5\uff08\u4e8c\uff09\uff08lldb \u8c03\u8bd5\u5668\uff09 - \u6781\u5ba2\u5206\u4eab"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://blog.csdn.net/zlmm741/article/details/105538556"}),"(1\u6761\u6d88\u606f) \u7b2c\u4e5d\u7ae0 Android \u539f\u751f\u7a0b\u5e8f\u52a8\u6001\u8c03\u8bd5\uff08\u4e8c\uff09\uff08lldb \u8c03\u8bd5\u5668\uff09_zlmm741\u7684\u535a\u5ba2-CSDN\u535a\u5ba2_android lldb")))),(0,n.kt)("h3",m({},{id:"debug-native"}),"debug native"),(0,n.kt)("p",null,"\u4ee5\u4e0b\u4e09\u7bc7\u5e94\u8be5\u662f\u4e00\u6837\u7684\uff1a"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://zhuanlan.zhihu.com/p/24867284"}),"\u5982\u4f55\u8c03\u8bd5Android Native Framework - \u77e5\u4e4e"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://github.com/tiann/android-native-debug"}),"tiann/android-native-debug: Debug Android Framework Native Code Tutorial."))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://weishu.me/2016/05/30/how-to-debug-android-framework/"}),"\u5982\u4f55\u8c03\u8bd5Android Framework\uff1f | Weishu's Notes"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://www.cnblogs.com/ciml/p/14154668.html"}),"LLDB\u8c03\u8bd5Android Native\u7a0b\u5e8f - Coding&Life - \u535a\u5ba2\u56ed"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://blog.csdn.net/qq_23542165/article/details/121275404"}),"(1\u6761\u6d88\u606f) \u3010\u5b89\u5353framework\u5b9e\u6218\u3011\u4f7f\u7528lldb\u8c03\u8bd5Android native\u6e90\u7801_nianxing123\u7684\u535a\u5ba2-CSDN\u535a\u5ba2"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://www.jianshu.com/p/3eb6315cb710"}),"\u3010\u5b89\u5353framework\u5b9e\u6218\u3011\u4f7f\u7528lldb\u8c03\u8bd5Android native\u6e90\u7801 - \u7b80\u4e66"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://juejin.cn/post/6994708442233946119"}),"\u5b89\u5353\u5e95\u5c42 native \u4ee3\u7801\u7684\u8c03\u8bd5 - \u6398\u91d1")))),(0,n.kt)("h3",m({},{id:"lldb-relative"}),"LLDB relative"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://www.jianshu.com/p/8a9fd3b2b9ae"}),"LLDB\u8c03\u8bd5\u548c\u5b9e\u6218 - \u7b80\u4e66"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://juejin.cn/post/6844903794740822029"}),"LLDB\u4f7f\u7528\u8be6\u89e3\u4ee5\u53ca\u65ad\u70b9\u8c03\u8bd5\u6559\u7a0b - \u6398\u91d1"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://stackoverflow.com/questions/61649693/there-is-no-lldb-in-sdk-manager-in-android-studio"}),"There is no LLDB in sdk manager in android-studio - Stack Overflow"))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},(0,n.kt)("a",m({parentName:"p"},{href:"https://stackoverflow.com/questions/31122871/lldb-error-unable-to-resolve-breakpoint-to-any-actual-locations"}),"macos - LLDB Error: Unable to resolve breakpoint to any actual locations - Stack Overflow")))),(0,n.kt)("h3",m({},{id:"fixed-ldlld-error-undefined-symbol-graphic_policyint"}),"FIXED: ",(0,n.kt)("inlineCode",{parentName:"h3"},"ld.lld: error: undefined symbol: graphic_policy(int)")),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1645588183041-6643592b34632faef340ffe8a6f9baa7597d40faf43c97daffb862cb6e37256f.png",alt:"picture 25"})),"  "),(0,n.kt)("p",null,"\u8fd9\u4e2a\u539f\u56e0\uff0c\u6211\u5177\u4f53\u4e5f\u4e0d\u6e05\u695a\uff0c\u56e0\u4e3a\u4e00\u662f\u4ee5\u524d\u6ca1\u6709\u5355\u72ec\u7f16\u8fc7",(0,n.kt)("inlineCode",{parentName:"p"},"native"),"\uff0c\u4e8c\u662f\u540e\u6765\u53c8\u6539\u4e86\u5f88\u591a ",(0,n.kt)("inlineCode",{parentName:"p"},"surfaceflinger")," \u90e8\u5206\uff0c\u770b\u8fd9\u5916\u90e8\u7684\u62a5\u9519\u4fe1\u606f\uff0c\u4f3c\u4e4e\u6b63\u4e0e\u6211\u6539\u7684\u90e8\u5206\u6709\u5173\uff0c\u4f46\u5177\u4f53\u5230\u5185\u90e8\u53c8\u53d1\u73b0\u4f3c\u4e4e\u65e0\u5173\u2026\u2026"),(0,n.kt)("p",null,"\u6240\u4ee5\u6211\u76ee\u524d\u7684\u505a\u6cd5\u5c31\u662f\u5148\u628a\u5b83\u6ce8\u91ca\u6389\uff0c\u8fd9\u770b\u8d77\u6765\u597d\u50cf\u5f71\u54cd\u4e0d\u5927\u2026\u2026"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1645588365881-e75c80d6ffb6606d4b6b3fb638e47a1a49a406b549428071142ea9bd0343f66d.png",alt:"picture 26"})),"  "),(0,n.kt)("p",null,"\u7136\u540e\u91cd\u65b0\u7f16\u8bd1\uff0c\u76ee\u524d\u4f3c\u4e4e\u4e00\u5207\u90fd\u5f88\u6b63\u5e38\uff01"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1645588403242-61bab44d027d5b9b2b3b5096c421502c1a2aac970732de2125f0aef3588adb31.png",alt:"picture 27"})),"  "),(0,n.kt)("h2",m({},{id:"\u5c5e\u6027\u8be6\u89e3"}),"\u5c5e\u6027\u8be6\u89e3"),(0,n.kt)("h3",m({},{id:"\u5b98\u65b9\u53c2\u8003"}),"\u5b98\u65b9\u53c2\u8003"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",m({parentName:"li"},{href:"https://source.android.com/devices/architecture/sysprops-apis"}),"\u5c06\u7cfb\u7edf\u5c5e\u6027\u4f5c\u4e3a API \u5b9e\u73b0 \xa0|\xa0 Android \u5f00\u6e90\u9879\u76ee \xa0|\xa0 Android Open Source Project"))),(0,n.kt)("h3",m({},{id:"\u7cfb\u7edf\u5c5e\u6027\u89e3\u51b3\u65b9\u6848\u5bf9\u7167\u8868"}),"\u7cfb\u7edf\u5c5e\u6027\u89e3\u51b3\u65b9\u6848\u5bf9\u7167\u8868"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",m({parentName:"tr"},{align:null}),"-"),(0,n.kt)("th",m({parentName:"tr"},{align:null}),"native get"),(0,n.kt)("th",m({parentName:"tr"},{align:null}),"native set"),(0,n.kt)("th",m({parentName:"tr"},{align:null}),"java get/set"),(0,n.kt)("th",m({parentName:"tr"},{align:null}),"adb get/set"),(0,n.kt)("th",m({parentName:"tr"},{align:null}),"note"))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",m({parentName:"tr"},{align:null}),"define ",(0,n.kt)("inlineCode",{parentName:"td"},"persist.XXX")," in ",(0,n.kt)("inlineCode",{parentName:"td"},"SurfaceFlingerProperties")),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y(maybe?)"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"N"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"\u5df2\u67e5se\u7b56\u7565\u4e2dsf\u4e0d\u5141\u8bb8adb\u4f7f\u7528")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",m({parentName:"tr"},{align:null}),"define ",(0,n.kt)("inlineCode",{parentName:"td"},"persist.XXX")," in ",(0,n.kt)("inlineCode",{parentName:"td"},"device/**.props")),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"N"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y(maybe?)"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"db\u4fee\u6539\u540e\uff0csf\u4e2d\u4f3c\u4e4e\u4f9d\u65e7\u662f\u65e7\u503c")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",m({parentName:"tr"},{align:null}),"define ",(0,n.kt)("inlineCode",{parentName:"td"},"persist.XXX")," both in ",(0,n.kt)("inlineCode",{parentName:"td"},"SurfaceFlingerProperties")," and ",(0,n.kt)("inlineCode",{parentName:"td"},"device/**.props")),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y(maybe?)"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y(maybe?)"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"Y"),(0,n.kt)("td",m({parentName:"tr"},{align:null}),"1. \u611f\u89c9\u6709\u4e9b\u7e41\u7410\uff0c2. \u4e5f\u8bb8\u5e94\u8be5\u72ec\u7acb\u5199\u4e2asysprops \u800c\u975e\u5199\u8fdb ",(0,n.kt)("inlineCode",{parentName:"td"},"SurfaceFlingerProperties"),"\uff08\u56e0\u4e3a\u90a3\u662f\u5c5e\u4e8e\u5e73\u53f0\u7684\uff09")))),(0,n.kt)("h3",m({},{id:"\u5c5e\u6027\u547d\u4ee4"}),"\u5c5e\u6027\u547d\u4ee4"),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-sh"}),"adb shell getprop\n\nadb shell setprop\n\n# \u76d1\u63a7\u6240\u6709\u5c5e\u6027\nadb shell watchprop\n")),(0,n.kt)("p",null,"ref:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",m({parentName:"li"},{href:"https://blog.csdn.net/heqiangflytosky/article/details/69432749"}),"(1\u6761\u6d88\u606f) Android\u5b9e\u7528\u6280\u5de7\u4e4badb\u547d\u4ee4\uff1agetprop\uff0csetprop\uff0cwatchprops\u547d\u4ee4\u7684\u4f7f\u7528_\u5bd2\u6c5f\u84d1\u7b20\u7684\u4e13\u680f-CSDN\u535a\u5ba2_adb setprop"))),(0,n.kt)("h3",m({},{id:"\u5c5e\u6027\u5217\u8868"}),"\u5c5e\u6027\u5217\u8868"),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-text"}),'// File: sysprop.proto\n\nsyntax = "proto3";\n\npackage sysprop;\n\nenum Access {\n  Readonly = 0;\n  Writeonce = 1;\n  ReadWrite = 2;\n}\n\nenum Owner {\n  Platform = 0;\n  Vendor = 1;\n  Odm = 2;\n}\n\nenum Scope {\n  Public = 0;\n  Internal = 2;\n}\n\nenum Type {\n  Boolean = 0;\n  Integer = 1;\n  Long = 2;\n  Double = 3;\n  String = 4;\n  Enum = 5;\n\n  BooleanList = 20;\n  IntegerList = 21;\n  LongList = 22;\n  DoubleList = 23;\n  StringList = 24;\n  EnumList = 25;\n}\n\nmessage Property {\n  string api_name = 1;\n  Type type = 2;\n  Access access = 3;\n  Scope scope = 4;\n  string prop_name = 5;\n  string enum_values = 6;\n  bool integer_as_bool = 7;\n  string legacy_prop_name = 8;\n}\n\nmessage Properties {\n  Owner owner = 1;\n  string module = 2;\n  repeated Property prop = 3;\n}\n')),(0,n.kt)("h3",m({},{id:"\u5c5e\u6027\u5728adb\u4e2d\u7684\u8bbf\u95ee"}),"\u5c5e\u6027\u5728adb\u4e2d\u7684\u8bbf\u95ee"),(0,n.kt)("p",null,"\u7531\u4e8e ",(0,n.kt)("inlineCode",{parentName:"p"},"surfaceflinger_display_prop")," \u88ab\u914d\u7f6e\u4e86\u9664\u4e86 ",(0,n.kt)("inlineCode",{parentName:"p"},"init")," \u548c ",(0,n.kt)("inlineCode",{parentName:"p"},"surfaceflinger")," \u90fd\u4e0d\u53ef\u4ee5\u8bbf\u95ee\uff0c\u6240\u4ee5 adb \u662f\u65e0\u6cd5\u83b7\u53d6\u4fe1\u606f\u7684\u3002"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644961947306-365a2ba35a5553755d4d32e08685dacc3c8fa442e74c22cc3b76fa3107933f23.png",alt:"picture 17"})),"  "),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644962007430-63053d9457f81699f582c2d933e4b7629c6fbd02d647bbb01706d67373eb4c02.png",alt:"picture 18"})),"  "),(0,n.kt)("p",null,"\u56e0\u6b64\u6211\u4eec\u6700\u597d\u81ea\u5b9a\u4e49\u4e00\u4e2a\u914d\u7f6e\u9879\u3002"),(0,n.kt)("h3",m({},{id:"\u5c5e\u6027\u5728\u4ee3\u7801\u4e2d\u7684\u8bbf\u95ee"}),"\u5c5e\u6027\u5728\u4ee3\u7801\u4e2d\u7684\u8bbf\u95ee"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644956365781-f7faee0f87bea20047027cf2544874972ed15f499de8971cbdd5769c3f8b6cd5.png",alt:"picture 15"})),"  "),(0,n.kt)("h3",m({},{id:"systemproperties-\u548c-settingsprovider"}),(0,n.kt)("inlineCode",{parentName:"h3"},"SystemProperties")," \u548c ",(0,n.kt)("inlineCode",{parentName:"h3"},"SettingsProvider")),(0,n.kt)("p",null,"\u76ee\u524d\u770b\u5230\u6700\u8be6\u7ec6\u7684\u4e00\u7bc7\u6587\u7ae0\uff1a- ",(0,n.kt)("a",m({parentName:"p"},{href:"https://blog.csdn.net/wenzhi20102321/article/details/120029551"}),"(1\u6761\u6d88\u606f) Android \u7cfb\u7edf\u5c5e\u6027\u8bfb\u53d6\u548c\u8bbe\u7f6e\u8be6\u89e3_wenzhi\u7684\u535a\u5ba2-CSDN\u535a\u5ba2_android\u7cfb\u7edf\u5c5e\u6027\u7684\u8bfb\u53d6\u548c\u8bbe\u7f6e"),"\uff0c \u8fd9\u91cc\u9762\u91cd\u70b9\u5bf9\u6bd4\u4e86 ",(0,n.kt)("inlineCode",{parentName:"p"},"SettingsProvider")," \u548c ",(0,n.kt)("inlineCode",{parentName:"p"},"SystemProperties"),"\u7684\u8bfb\u53d6\u95ee\u9898\u3002"),(0,n.kt)("p",null,"\u5176\u4e2d\uff0c",(0,n.kt)("inlineCode",{parentName:"p"},"SystemProperties")," \u65e2\u53ef\u4ee5\u5728C++\u4e2d\u8c03\u7528\uff0c\u4e5f\u53ef\u4ee5\u5728Java\u5c42\u8c03\u7528\uff0c\u56e0\u6b64\u662f\u6700\u9002\u5408\u6211\u4eec ",(0,n.kt)("inlineCode",{parentName:"p"},"surfaceflinger")," \u7684\u4fee\u6539\u76ee\u6807\u7684\u3002"),(0,n.kt)("p",null,(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644954678894-2184d72cee016ae198e398c77e4365a038f279c7b4a91b3648fc7a5c004bcc34.png",alt:"picture 8"})),"  "),(0,n.kt)("p",null,"\u5728JAVA\u4e2d\u8c03\u7528 ",(0,n.kt)("inlineCode",{parentName:"p"},"SystemProperties"),":"),(0,n.kt)("p",null,"!!! tip\n\u5982\u679c\u662f\u8c03\u7528 ",(0,n.kt)("inlineCode",{parentName:"p"},"surfaceflinger")," \u7684\u5c5e\u6027\uff0c\u5373 ",(0,n.kt)("inlineCode",{parentName:"p"},"surfaceflinger/sysprop/SurfaceFlingerProperties.sysprop"),"\uff0c\u5219\u5728java\u4e2d\u8981\u5b9a\u4e49\u4e3a ",(0,n.kt)("inlineCode",{parentName:"p"},"android.sysprop.SurfaceFlingerProperties"),"\uff0c\u5982\u4e0b\uff1a\n",(0,n.kt)("img",m({parentName:"p"},{src:"https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644955082677-1b15e5eb9ae9419a5fe94569e30d394eebcfe8610ff8ba0295cc8d1781118b9c.png",alt:"picture 9"})),"  "),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{className:"language-java"}),"import android.os.SystemProperties; //\u9700\u8981uid\u7cfb\u7edf\u6743\u9650\n\n\n//\u8bfb\u53d6\nString SystemProperties.get(String key)\uff1b\nint SystemProperties.getInt(String key, int def)\nlong SystemProperties.getLong(String key, long def)\nboolean SystemProperties.getBoolean(String key, boolean def) \n\n//\u8bbe\u7f6e\nvoid SystemProperties.set(String key, String val)\n")),(0,n.kt)("p",null,"\u5728C++\u4e2d\u8c03\u7528 ",(0,n.kt)("inlineCode",{parentName:"p"},"SystemProperties"),":"),(0,n.kt)("p",null,"cpp++\n//\u8bfb\u53d6\u6570\u503c\nchar flag","[PROPERTY_VALUE_MAX]",';\nproperty_get("persist.sys.camera.port", flag, "0");\nint port = flag',"[0]"," - '0'; //\u9002\u7528\u4e8eflag\u5b57\u7b26\u4e32\u6570\u503c\u5c0f\u4e8e10\u7684\u60c5\u51b5"),(0,n.kt)("p",null,'//\u8bbe\u7f6e\nproperty_get("persist.sys.camera.port", "0");'),(0,n.kt)("pre",null,(0,n.kt)("code",m({parentName:"pre"},{}),"\n### TODO: \u914d\u7f6e\u7cfb\u7edf\u5168\u5c40\u56fa\u5b9a\u5c5e\u6027\n\n\u6211\u5148\u5c1d\u8bd5\u4e86\u5728`device`\u4e2d\u6dfb\u52a0\u5c5e\u6027\u3002\n\n![picture 19](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644986544796-882285542154ae30c7c129ae88ac8affb8d9853f3cf0e98b1135441a4999bb89.png)  \n\n\u6211\u540e\u6765\u53d1\u73b0\u5728`/system/libsysprop`\u4e0b\u5b9a\u4e49\u4e86\u5f88\u591a\u5c5e\u6027\uff0c\u5e76\u4e14\u6709\u5728`adb shell getprop`\u4e2d\u80fd\u627e\u5230\u7684\uff0c\u6bd4\u5982\uff1a`gsm.network.type`\u3002\n\n![picture 21](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644988047702-11880135ad9bea5c57f480e13240046c826a7d7194e79597e8ef6f8a802cb29b.png)  \n\n![picture 22](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644988112942-0601bf85ddc25e97e359f58ab3bdd5fe9330d14a6c4b200b888cdce26528304d.png)  \n\n\u8fd9\u4e2a\u6a21\u5757\u7684 `Android.bp` \u5176\u5b9e\u5f88\u7b80\u5355\uff0c\u5c31\u662f\u628a\u76ee\u5f55\u4e0b\u7684\u6240\u6709 `.sysprop` \u6587\u4ef6\u90fd\u52a0\u8f7d\u3002\n\n![picture 20](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644987990277-670cf265944ab6b555e1355d089659e20b72afcb4e84172b1ea676c9b115229d.png)  \n\n### `SystemProperties` \u903b\u8f91\n\n\u800c\u5728\u8fd9\u7bc7\u6587\u7ae0\uff1a- [(1\u6761\u6d88\u606f) Android \u77e5\u8bc6\u70b9 040 \u2014\u2014 setprop persist.\u5c5e\u6027_adc-CSDN\u535a\u5ba2](https://blog.csdn.net/yush34/article/details/105275120) \u4e2d\u4ecb\u7ecd\u4e86 `SystemProperties` \u7684\u7a0b\u5e8f\u903b\u8f91\u3002\n\n\u5c5e\u6027\u6587\u4ef6\u8bfb\u53d6\u7684\u987a\u5e8f\u4f9d\u6b21\u4e3a\uff1a` /default.prop -> /system/build.prop -> /system/default.prop -> /data/local.prop`\n\n![picture 10](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644955172003-4ea039f8e85c0cd621f691954558e845a8a95ae8593a4dcef49da77ccab4c982.png)  \n\n\u5176\u4e2d `persist.` \u5f00\u5934\u7684\u5c06\u6709\u5199\u5165\u52a8\u4f5c\uff08\u5e76\u4e14\u91cd\u542f\u540e\u4e0d\u4f1a\u91cd\u7f6e\uff09\uff1a\n\n![picture 11](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644955251254-1c27ee0e9857690399cf0534803c7620bdba6f542d3acdb5aa331901c66fce0f.png)  \n\n### `SystemProperties` \u53ef\u914d\u7f6e\u533a\u57df\n\n\u6839\u636e\u8fd9\u7bc7\u6587\u7ae0\uff1a- [Android \u6dfb\u52a0\u81ea\u5b9a\u4e49\u7cfb\u7edf\u5c5e\u6027_marton_13\u7684\u535a\u5ba2-\u7a0b\u5e8f\u5458\u79d8\u5bc6 - \u7a0b\u5e8f\u5458\u79d8\u5bc6](https://www.cxymm.net/article/qq_27256793/80455514) \u4ecb\u7ecd\u5230\u4e86\u4e00\u4e2a\u5176\u4ed6\u6587\u7ae0\u6ca1\u600e\u4e48\u63d0\u5230\u8fc7\u7684\u5728 `system/core/rootdir/int.rc` \u91cc\u914d\u4e2a\u4eba\u81ea\u5b9a\u4e49\u5c5e\u6027\uff1a\n\n![picture 12](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644955753951-c879eec8b7fd881d71dca82deb4df048e5e8209f90890dda8622fca9b2783754.png)  \n\nFIXME: \u6211\u67e5\u4e86\u4e00\u4e0b\uff0c\u8fd9\u91cc\u786e\u5b9e\u6709\u914d\u5c5e\u6027\u7684\uff0c\u4e0d\u8fc7\u4e0d\u591a\uff0c\u800c\u4e14\u597d\u50cf\u8fd8\u548c\u662f\u5426 `persist` \u7684\u903b\u8f91\u6df7\u5728\u4e00\u8d77\uff0c\u4f60\u4e5f\u4e0d\u6e05\u695a\u5982\u679c\u5728\u8fd9\u91cc\u5b9a\u4e49 `persist.` \u53d8\u91cf\u662f\u5426\u6709\u6548\uff0c\u56e0\u4e3a\u6709\u53ef\u80fd\u5728\u751f\u6548\u51fd\u6570\u4e4b\u540e\u3002\n\n![picture 13](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644955843838-59901699d2a7d917cbcdfc8cf863b9c3a9242240177fd0dd3c9ae48ff081ef1c.png)  \n\n### \u5728 `build.prop` \u4e2d\u914d\u7f6e\u5b9e\u4f8b\n\n\u8fd9\u7bc7\u6587\u7ae0\u633a\u63a8\u8350\uff1a- [Android\u7cfb\u7edf\u5f00\u53d1\u5165\u95e8-3.\u6dfb\u52a0\u7cfb\u7edf\u5c5e\u6027 | \u4e00\u53f6\u77e5\u79cb](http://qiushao.net/2019/11/20/Android%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%85%A5%E9%97%A8/3-%E6%B7%BB%E5%8A%A0%E7%B3%BB%E7%BB%9F%E5%B1%9E%E6%80%A7/)\uff0c \u91cc\u9762\u8bf4\u4e86 Android 9.0 \u4e4b\u540egoogle\u4e0d\u63a8\u8350\u628aproperty\u76f4\u63a5\u52a0\u8f7d `/system` \u5206\u533a\uff0c\u5426\u5219\u4e00\u5b9a\u8981\u5728 `BoardConfig.mk` \u91cc\u7ee7\u7eed\u914d\u7f6e\u3002\n\n![picture 16](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644956628048-67fecc6f07edc248a2306332452914807a7f3e880e70ea1c36461e15b9b469fa.png)  \n\n\u5728\u8fd9\u7bc7\u6587\u7ae0\uff1a- [(1\u6761\u6d88\u606f) 02 Android\u7cfb\u7edf\u4e4b\u6dfb\u52a0\u7cfb\u7edf\u5c5e\u6027_\u672c\u672b\u5b9e\u9a8c\u5ba4-CSDN\u535a\u5ba2_android \u6dfb\u52a0\u7cfb\u7edf\u5c5e\u6027](https://blog.csdn.net/feit2417/article/details/105209725) \u4e2d\uff0c\u4ecb\u7ecd\u4e86\u5728 `/system/build.prop` \u548c `/vendor/build.prop` \u4e0b\u914d\u7f6e\u5c5e\u6027\u5e76\u7f16\u8bd1\u7684\u65b9\u6cd5\uff1a\n\n![picture 14](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644956067014-b8b68a62375d4d06fcdc6f6a35793075686d98e942850db5d1e02ca2e5edc7a4.png)  \n\nFIXME: \u8fd9\u79cd\u76f4\u63a5\u5199\u8fdb `build.prop` \u5e76\u70e7\u5f55\u7684\u529e\u6cd5\uff0c\u80af\u5b9a\u662f\u53ef\u4ee5\u901a\u8fc7 `adb shell getprop` \u8bfb\u5230\u4e86\uff0c\u4f46\u662fc++\u4ee3\u7801\u548cjava\u4ee3\u7801\u91cc\u600e\u4e48\u8bfb\u5462\uff1f\n\n### FIXME: \u4fee\u6539\u5b8csysprop\u540eapi\u4e0d\u5339\u914d\u7684\u95ee\u9898\n\n\u4fee\u6539\u4e86\u6a21\u5757\u7684sysprop\u4e4b\u540e\uff0c\u91cd\u65b0\u7f16\u8bd1\u6574\u673a\u4f1a\u6709api\u4e0d\u5339\u914d\u7684\u95ee\u9898\u3002\n\n![picture 14](https://mark-vue-oss.oss-cn-hangzhou.aliyuncs.com/frameworks-howto-1644747304677-4be7f7fdbf1e0755f93dc2727db6c652ad79244b90886433ca679fad88830f11.png)  \n\n\u6839\u636e\u63d0\u793a\u66f4\u65b0\u5373\u53ef\u3002\n\nTODO: \u5728\u8fd9\u4e4b\u540e\uff0c\u6216\u8bb8\u5c31\u53ef\u4ee5\u7528`adb shell getprop`\u7684\u65b9\u5f0f\u83b7\u5f97\u8fd9\u4e9b\u5c5e\u6027\u4fe1\u606f\u4e86\u3002\n")))}b.isMDXComponent=!0}}]);